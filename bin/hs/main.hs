import Unsafe.Coerce
import Data.Word
import Data.Bits
app = unsafeCoerce
_ins_bool = \x-> x True False
_eli_bool = \x-> case x of { True -> (\t-> \f-> t); False -> (\t-> \f-> f); }
_ins_nat = \x-> (x 0 (\p-> 1 + p)) :: Integer
_eli_nat = \x-> \z-> \s-> if x == 0 then z else (app s (x - 1))
_ins_string = \x-> x [] (\h t-> (toEnum (fromIntegral h) :: Char) : t)
_eli_string = \x-> case x::String of { []-> \n e-> n; (c:cs)-> \n e-> e(fromIntegral(fromEnum c) :: Word16)cs }
_ins_u16 = \x-> x (\x -> (go 0 0 x)::Word16) where go i u x = if i<16 then x u (\x-> app go (i + 1) u x) (\x-> app go (i+1) (u.|.(shiftL 1 i)) x) else u
_eli_u16 = \x-> (\t -> t (go 0 (\n o i-> n) (x::Word16))) where go i w x = if i<16 then go (i+1) (if (shiftR x (16-i-1).&.1)>0 then \n o i-> app i w else \n o i-> app o w) x else w
_bit = ()
_bits = ()
_bits_add = (\_a-> (\_b-> (app (app (app _b _a) (\_b_pred-> (app (app (app _a _b) (\_a_pred-> (app _bits_0 (app (app _bits_add _a_pred) _b_pred)))) (\_a_pred-> (app _bits_1 (app (app _bits_add _a_pred) _b_pred)))))) (\_b_pred-> (app (app (app _a _b) (\_a_pred-> (app _bits_1 (app (app _bits_add _a_pred) _b_pred)))) (\_a_pred-> (app _bits_0 (app (app _bits_add (app _bits_inc _a_pred)) _b_pred))))))))
_bits_chunks_of = (\_len-> (\_bits-> (app (app (app (app _bits_chunks_of_go _len) _bits) _len) _bits_nil)))
_bits_chunks_of_go = (\_len-> (\_bits-> (\_need-> (\_chunk-> (app (app (app _bits (app (app _list_cons (app _bits_reverse _chunk)) _list_nil)) (\_bits_pred-> (app (app (_eli_nat _need) (let _head_5 = (app _bits_reverse _chunk) in (let _tail_6 = (app (app (app (app _bits_chunks_of_go _len) _bits) _len) _bits_nil) in (app (app _list_cons _head_5) _tail_6)))) (\_need_pred-> (let _chunk_6 = (app _bits_0 _chunk) in (app (app (app (app _bits_chunks_of_go _len) _bits_pred) _need_pred) _chunk_6)))))) (\_bits_pred-> (app (app (_eli_nat _need) (let _head_5 = (app _bits_reverse _chunk) in (let _tail_6 = (app (app (app (app _bits_chunks_of_go _len) _bits) _len) _bits_nil) in (app (app _list_cons _head_5) _tail_6)))) (\_need_pred-> (let _chunk_6 = (app _bits_1 _chunk) in (app (app (app (app _bits_chunks_of_go _len) _bits_pred) _need_pred) _chunk_6))))))))))
_bits_concat = (\_a-> (\_b-> (app (app (app _a _b) (\_a_pred-> (app _bits_0 (app (app _bits_concat _a_pred) _b)))) (\_a_pred-> (app _bits_1 (app (app _bits_concat _a_pred) _b))))))
_bits_eql = (\_a-> (\_b-> (app (app (app _a (app (app (app _b _bool_true) (\_b_pred-> _bool_false)) (\_b_pred-> _bool_false))) (\_a_pred-> (app (app (app _b _bool_false) (\_b_pred-> (app (app _bits_eql _a_pred) _b_pred))) (\_b_pred-> _bool_false)))) (\_a_pred-> (app (app (app _b _bool_false) (\_b_pred-> _bool_false)) (\_b_pred-> (app (app _bits_eql _a_pred) _b_pred)))))))
_bits_inc = (\_a-> (app (app (app _a (app _bits_1 _bits_nil)) (\_a_pred-> (app _bits_1 _a_pred))) (\_a_pred-> (app _bits_0 (app _bits_inc _a_pred)))))
_bits_nil = (\_nil-> (\_0-> (\_1-> _nil)))
_bits_reverse = (\_a-> (app (app _bits_reverse_tco _a) _bits_nil))
_bits_reverse_tco = (\_a-> (\_r-> (app (app (app _a _r) (\_a_pred-> (app (app _bits_reverse_tco _a_pred) (app _bits_0 _r)))) (\_a_pred-> (app (app _bits_reverse_tco _a_pred) (app _bits_1 _r))))))
_bits_show = (\_a-> (app (app (app _a "") (\_a_pred-> (app (app _string_cons (48::Word16)) (app _bits_show _a_pred)))) (\_a_pred-> (app (app _string_cons (49::Word16)) (app _bits_show _a_pred)))))
_bits_tail = (\_a-> (app (app (app _a _bits_nil) (\_a_pred-> _a_pred)) (\_a_pred-> _a_pred)))
_bits_to_nat = (\_b-> (app (app (app _b (0::Integer)) (\_b_pred-> (app (app _nat_mul (2::Integer)) (app _bits_to_nat _b_pred)))) (\_b_pred-> (app _nat_succ (app (app _nat_mul (2::Integer)) (app _bits_to_nat _b_pred))))))
_bits_0 = (\_pred-> (\_nil-> (\_0-> (\_1-> (app _0 _pred)))))
_bits_1 = (\_pred-> (\_nil-> (\_0-> (\_1-> (app _1 _pred)))))
_bit_0 = (\_0-> (\_1-> _0))
_bit_1 = (\_0-> (\_1-> _1))
_bool = ()
_bool_and = (\_a-> (\_b-> (app (app (_eli_bool _a) _b) _bool_false)))
_bool_false = (_ins_bool (\_true-> (\_false-> _false)))
_bool_not = (\_a-> (app (app (_eli_bool _a) _bool_false) _bool_true))
_bool_or = (\_a-> (\_b-> (app (app (_eli_bool _a) _bool_true) _b)))
_bool_true = (_ins_bool (\_true-> (\_false-> _true)))
_char = _u16
_char_new = (\_b0-> (\_b1-> (\_b2-> (\_b3-> (\_b4-> (\_b5-> (\_b6-> (\_b7-> (\_b8-> (\_b9-> (\_ba-> (\_bb-> (\_bc-> (\_bd-> (\_be-> (\_bf-> (let _kf_16 = (app (app _b0 _word_0) _word_1) in (let _ke_17 = (app (app _b1 _word_0) _word_1) in (let _kd_18 = (app (app _b2 _word_0) _word_1) in (let _kc_19 = (app (app _b3 _word_0) _word_1) in (let _kb_20 = (app (app _b4 _word_0) _word_1) in (let _ka_21 = (app (app _b5 _word_0) _word_1) in (let _k9_22 = (app (app _b6 _word_0) _word_1) in (let _k8_23 = (app (app _b7 _word_0) _word_1) in (let _k7_24 = (app (app _b8 _word_0) _word_1) in (let _k6_25 = (app (app _b9 _word_0) _word_1) in (let _k5_26 = (app (app _ba _word_0) _word_1) in (let _k4_27 = (app (app _bb _word_0) _word_1) in (let _k3_28 = (app (app _bc _word_0) _word_1) in (let _k2_29 = (app (app _bd _word_0) _word_1) in (let _k1_30 = (app (app _be _word_0) _word_1) in (let _k0_31 = (app (app _bf _word_0) _word_1) in (let _kx_32 = _word_nil in (app _u16_new (app _k0_31 (app _k1_30 (app _k2_29 (app _k3_28 (app _k4_27 (app _k5_26 (app _k6_25 (app _k7_24 (app _k8_23 (app _k9_22 (app _ka_21 (app _kb_20 (app _kc_19 (app _kd_18 (app _ke_17 (app _kf_16 _kx_32))))))))))))))))))))))))))))))))))))))))))))))))))
_cmp = ()
_cmp_as_eql = (\_cmp-> (app (app (app _cmp _bool_false) _bool_true) _bool_false))
_cmp_as_gte = (\_cmp-> (app (app (app _cmp _bool_false) _bool_true) _bool_true))
_cmp_as_gtn = (\_cmp-> (app (app (app _cmp _bool_false) _bool_false) _bool_true))
_cmp_as_lte = (\_cmp-> (app (app (app _cmp _bool_true) _bool_true) _bool_false))
_cmp_as_ltn = (\_cmp-> (app (app (app _cmp _bool_true) _bool_false) _bool_false))
_cmp_eql = (\_ltn-> (\_eql-> (\_gtn-> _eql)))
_cmp_gtn = (\_ltn-> (\_eql-> (\_gtn-> _gtn)))
_cmp_ltn = (\_ltn-> (\_eql-> (\_gtn-> _ltn)))
_dpair = (\_a-> (\_b-> ()))
_dpair_new = (\_fst-> (\_snd-> (\_new-> (app (app _new _fst) _snd))))
_debug_log = (\_s-> (\_x-> (app _x _unit_new)))
_either = (\_a-> (\_b-> ()))
_either_left = (\_value-> (\_left-> (\_right-> (app _left _value))))
_either_right = (\_value-> (\_left-> (\_right-> (app _right _value))))
_empty = ()
_empty_absurd = (\_x-> _x)
_fm_binder = ()
_fm_binder_new = (\_eras-> (\_name-> (\_term-> (\_new-> (app (app (app _new _eras) _name) _term)))))
_fm_check = (\_v-> ())
_fm_check_bind = (\_a-> (\_f-> (app _a (\_a_value-> (\_a_errors-> (app (app _a_value (app (app _fm_check_result _maybe_none) _a_errors)) (\_got_value-> (app (app _f _got_value) (\_b_value-> (\_b_errors-> (app (app _fm_check_result _b_value) (app (app _list_concat _a_errors) _b_errors))))))))))))
_fm_check_monad = (app (app _monad_new _fm_check_bind) _fm_check_pure)
_fm_check_none = (app (app _fm_check_result _maybe_none) _list_nil)
_fm_check_pure = (\_value-> (app (app _fm_check_result (app _maybe_some _value)) _list_nil))
_fm_check_result = (\_value-> (\_errors-> (\_result-> (app (app _result _value) _errors))))
_fm_check_value = (\_chk-> (app _chk (\_chk_value-> (\_chk_errors-> _chk_value))))
_fm_comp = ()
_fm_comp_app = (\_func-> (\_argm-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app (app _app _func) _argm))))))))))))))
_fm_comp_chr = (\_chrx-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app _chr _chrx)))))))))))))
_fm_comp_compile = (\_term-> (\_type-> (\_defs-> (\_ctx-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> (app (app _monad_pure _maybe_monad) (app _fm_comp_var _term_name))))) (\_term_name-> (app (app _monad_pure _maybe_monad) (app _fm_comp_ref _term_name)))) (app (app _monad_pure _maybe_monad) _fm_comp_nil)) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (app (app _monad_pure _maybe_monad) _fm_comp_nil))))))) (\_term_name-> (\_term_body-> (app (app _type _maybe_none) (\_type_value-> (let _typv_7 = (app (app _fm_term_reduce _type_value) _defs) in (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _typv_7 (\_typv_name-> (\_typv_indx-> _maybe_none))) (\_typv_name-> _maybe_none)) _maybe_none) (\_typv_eras-> (\_typv_self-> (\_typv_name-> (\_typv_xtyp-> (\_typv_body-> (let _ctx_size_13 = (app _list_length _ctx) in (let _self_var_14 = _term in (let _body_var_15 = (app (app _fm_term_var _term_name) _ctx_size_13) in (let _body_typ_16 = (app (app _typv_body _self_var_14) _body_var_15) in (let _body_ctx_17 = (app (app _list_cons (app (app _pair_new _term_name) _typv_xtyp)) _ctx) in (app (app (app _monad_bind _maybe_monad) (app (app (app (app _fm_comp_compile (app _term_body _body_var_15)) (app _maybe_some _body_typ_16)) _defs) _body_ctx_17)) (\_body_cmp-> (let _term_cmp_19 = (app (app (_eli_bool _typv_eras) _body_cmp) (app (app _fm_comp_lam _term_name) _body_cmp)) in (let _term_cmp_20 = (app (app (app (app _fm_comp_prim_of _type_value) _defs) _term_cmp_19) (\_prim_value-> (app (app _fm_comp_ins _prim_value) _term_cmp_19))) in (app (app _monad_pure _maybe_monad) _term_cmp_20)))))))))))))))) (\_typv_name-> (\_typv_body-> _maybe_none))) (\_typv_func-> (\_typv_argm-> _maybe_none))) (\_typv_name-> (\_typv_expr-> (\_typv_body-> _maybe_none)))) (\_typv_name-> (\_typv_expr-> (\_typv_body-> _maybe_none)))) (\_typv_done-> (\_typv_term-> (\_typv_type-> _maybe_none)))) (\_typv_name-> (\_typv_dref-> (\_typv_verb-> _maybe_none)))) (\_typv_path-> _maybe_none)) (\_typv_natx-> _maybe_none)) (\_typv_chrx-> _maybe_none)) (\_typv_strx-> _maybe_none)) (\_typv_path-> (\_typv_expr-> (\_typv_name-> (\_typv_with-> (\_typv_cses-> (\_typv_moti-> _maybe_none))))))))))))) (\_term_func-> (\_term_argm-> (app (app (app _monad_bind _maybe_monad) (app _fm_check_value (app (app (app (app (app _fm_term_check _term_func) _maybe_none) _defs) _ctx) _maybe_none))) (\_func_typ-> (let _func_typ_7 = (app (app _fm_term_reduce _func_typ) _defs) in (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _func_typ_7 (\_func_typ_name-> (\_func_typ_indx-> _maybe_none))) (\_func_typ_name-> _maybe_none)) _maybe_none) (\_func_typ_eras-> (\_func_typ_self-> (\_func_typ_name-> (\_func_typ_xtyp-> (\_func_typ_body-> (app (app (app _monad_bind _maybe_monad) (app (app (app (app _fm_comp_compile _term_func) _maybe_none) _defs) _ctx)) (\_func_cmp-> (let _func_cmp_14 = (app (app (app (app _fm_comp_prim_of _func_typ_7) _defs) _func_cmp) (\_prim_value-> (app (app _fm_comp_eli _prim_value) _func_cmp))) in (app (app (_eli_bool _func_typ_eras) (app (app _monad_pure _maybe_monad) _func_cmp_14)) (app (app (app _monad_bind _maybe_monad) (app (app (app (app _fm_comp_compile _term_argm) (app _maybe_some _func_typ_xtyp)) _defs) _ctx)) (\_argm_cmp-> (app (app _monad_pure _maybe_monad) (app (app _fm_comp_app _func_cmp_14) _argm_cmp)))))))))))))) (\_func_typ_name-> (\_func_typ_body-> _maybe_none))) (\_func_typ_func-> (\_func_typ_argm-> _maybe_none))) (\_func_typ_name-> (\_func_typ_expr-> (\_func_typ_body-> _maybe_none)))) (\_func_typ_name-> (\_func_typ_expr-> (\_func_typ_body-> _maybe_none)))) (\_func_typ_done-> (\_func_typ_term-> (\_func_typ_type-> _maybe_none)))) (\_func_typ_name-> (\_func_typ_dref-> (\_func_typ_verb-> _maybe_none)))) (\_func_typ_path-> _maybe_none)) (\_func_typ_natx-> _maybe_none)) (\_func_typ_chrx-> _maybe_none)) (\_func_typ_strx-> _maybe_none)) (\_func_typ_path-> (\_func_typ_expr-> (\_func_typ_name-> (\_func_typ_with-> (\_func_typ_cses-> (\_func_typ_moti-> _maybe_none))))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (let _ctx_size_7 = (app _list_length _ctx) in (app (app (app _monad_bind _maybe_monad) (app _fm_check_value (app (app (app (app (app _fm_term_check _term_expr) _maybe_none) _defs) _ctx) _maybe_none))) (\_expr_typ-> (app (app (app _monad_bind _maybe_monad) (app (app (app (app _fm_comp_compile _term_expr) _maybe_none) _defs) _ctx)) (\_expr_cmp-> (let _new_name_10 = (app _string_flatten (app (app _list_cons _term_name) (app (app _list_cons "_") (app (app _list_cons (app _nat_show _ctx_size_7)) _list_nil)))) in (let _body_var_11 = (app (app _fm_term_var _new_name_10) _ctx_size_7) in (let _body_val_12 = (app _term_body _body_var_11) in (let _body_ctx_13 = (app (app _list_cons (app (app _pair_new _term_name) _expr_typ)) _ctx) in (app (app (app _monad_bind _maybe_monad) (app (app (app (app _fm_comp_compile _body_val_12) _type) _defs) _body_ctx_13)) (\_body_cmp-> (app (app _monad_pure _maybe_monad) (app (app (app _fm_comp_let _new_name_10) _expr_cmp) _body_cmp))))))))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app (app _fm_comp_compile (app _term_body _term_expr)) _type) _defs) _ctx))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app (app (app _fm_comp_compile _term_term) (app _maybe_some _term_type)) _defs) _ctx))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (app (app _monad_pure _maybe_monad) _fm_comp_nil))))) (\_term_path-> (app (app _monad_pure _maybe_monad) _fm_comp_nil))) (\_term_natx-> (app (app _monad_pure _maybe_monad) (app _fm_comp_nat _term_natx)))) (\_term_chrx-> (app (app _monad_pure _maybe_monad) (app _fm_comp_chr _term_chrx)))) (\_term_strx-> (app (app _monad_pure _maybe_monad) (app _fm_comp_str _term_strx)))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> _maybe_none)))))))))))
_fm_comp_eli = (\_prim-> (\_expr-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app (app _eli _prim) _expr))))))))))))))
_fm_comp_hs = (\_comp-> (app (app (app (app (app (app (app (app (app (app (app _comp "()") (\_comp_name-> (app _string_flatten (app (app _list_cons "_") (app (app _list_cons (app _fm_comp_hs_name _comp_name)) _list_nil))))) (\_comp_name-> (app _string_flatten (app (app _list_cons "_") (app (app _list_cons (app _fm_comp_hs_name _comp_name)) _list_nil))))) (\_comp_name-> (\_comp_body-> (app _string_flatten (app (app _list_cons "(\\_") (app (app _list_cons (app _fm_comp_hs_name _comp_name)) (app (app _list_cons "-> ") (app (app _list_cons (app _fm_comp_hs _comp_body)) (app (app _list_cons ")") _list_nil))))))))) (\_comp_func-> (\_comp_argm-> (app _string_flatten (app (app _list_cons "(app ") (app (app _list_cons (app _fm_comp_hs _comp_func)) (app (app _list_cons " ") (app (app _list_cons (app _fm_comp_hs _comp_argm)) (app (app _list_cons ")") _list_nil))))))))) (\_comp_name-> (\_comp_expr-> (\_comp_body-> (app _string_flatten (app (app _list_cons "(let _") (app (app _list_cons (app _fm_comp_hs_name _comp_name)) (app (app _list_cons " = ") (app (app _list_cons (app _fm_comp_hs _comp_expr)) (app (app _list_cons " in ") (app (app _list_cons (app _fm_comp_hs _comp_body)) (app (app _list_cons ")") _list_nil)))))))))))) (\_comp_prim-> (\_comp_expr-> (app _string_flatten (app (app _list_cons "(_eli_") (app (app _list_cons (app _fm_comp_prim_name _comp_prim)) (app (app _list_cons " ") (app (app _list_cons (app _fm_comp_hs _comp_expr)) (app (app _list_cons ")") _list_nil))))))))) (\_comp_prim-> (\_comp_expr-> (app _string_flatten (app (app _list_cons "(_ins_") (app (app _list_cons (app _fm_comp_prim_name _comp_prim)) (app (app _list_cons " ") (app (app _list_cons (app _fm_comp_hs _comp_expr)) (app (app _list_cons ")") _list_nil))))))))) (\_comp_natx-> (app _string_flatten (app (app _list_cons "(") (app (app _list_cons (app _nat_show _comp_natx)) (app (app _list_cons "::Integer)") _list_nil)))))) (\_comp_chrx-> (app _string_flatten (app (app _list_cons "(") (app (app _list_cons (app _nat_show (app _bits_to_nat (app _word_to_bits (app _u16_to_word _comp_chrx))))) (app (app _list_cons "::Word16)") _list_nil)))))) (\_comp_strx-> (app _string_flatten (app (app _list_cons (app (app _string_cons (34::Word16)) _string_nil)) (app (app _list_cons (app _fm_escape _comp_strx)) (app (app _list_cons (app (app _string_cons (34::Word16)) _string_nil)) _list_nil)))))))
_fm_comp_hs_defs = (\_defs-> (let _list_1 = (app _map_to_list _defs) in (let _code_2 = (app (app _string_join "\n") (app (app _list_cons "import Unsafe.Coerce") (app (app _list_cons "import Data.Word") (app (app _list_cons "import Data.Bits") (app (app _list_cons "app = unsafeCoerce") (app (app _list_cons "_ins_bool = \\x-> x True False") (app (app _list_cons "_eli_bool = \\x-> case x of { True -> (\\t-> \\f-> t); False -> (\\t-> \\f-> f); }") (app (app _list_cons "_ins_nat = \\x-> (x 0 (\\p-> 1 + p)) :: Integer") (app (app _list_cons "_eli_nat = \\x-> \\z-> \\s-> if x == 0 then z else (app s (x - 1))") (app (app _list_cons "_ins_string = \\x-> x [] (\\h t-> (toEnum (fromIntegral h) :: Char) : t)") (app (app _list_cons "_eli_string = \\x-> case x::String of { []-> \\n e-> n; (c:cs)-> \\n e-> e(fromIntegral(fromEnum c) :: Word16)cs }") (app (app _list_cons "_ins_u16 = \\x-> x (\\x -> (go 0 0 x)::Word16) where go i u x = if i<16 then x u (\\x-> app go (i + 1) u x) (\\x-> app go (i+1) (u.|.(shiftL 1 i)) x) else u") (app (app _list_cons "_eli_u16 = \\x-> (\\t -> t (go 0 (\\n o i-> n) (x::Word16))) where go i w x = if i<16 then go (i+1) (if (shiftR x (16-i-1).&.1)>0 then \\n o i-> app i w else \\n o i-> app o w) x else w") (app (app _list_cons "") _list_nil)))))))))))))) in (let _code_3 = (app (app (app _list_for _list_1) _code_2) (\_def-> (\_code-> (app _def (\_def_fst-> (\_def_snd-> (app _def_snd (\_def_snd_name-> (\_def_snd_term-> (\_def_snd_type-> (\_def_snd_done-> (let _name_11 = (app _fm_name_from_bits _def_fst) in (let _line_12 = (app (app (app (app _fm_get _name_11) _fm_comp_hs_native_ops) (let _comp_12 = (app (app (app (app _fm_comp_compile _def_snd_term) (app _maybe_some _def_snd_type)) _defs) _list_nil) in (let _body_13 = (app (app _comp_12 "()") (\_comp_value-> (app _fm_comp_hs _comp_value))) in (app _string_flatten (app (app _list_cons "_") (app (app _list_cons (app _fm_comp_hs_name _name_11)) (app (app _list_cons " = ") (app (app _list_cons _body_13) _list_nil)))))))) (\_got_value-> _got_value)) in (app _string_flatten (app (app _list_cons _code) (app (app _list_cons _line_12) (app (app _list_cons "\n") _list_nil))))))))))))))))) in _code_3))))
_fm_comp_hs_name = (\_name-> (app (app (_eli_string _name) "") (\_name_head-> (\_name_tail-> (let _chr_3 = (app (app (_eli_bool (app (app (app _u16_btw (65::Word16)) _name_head) (90::Word16))) (app (app _u16_add _name_head) (app _nat_to_u16 (32::Integer)))) (app (app (_eli_bool (app (app _u16_eql _name_head) (46::Word16))) (95::Word16)) _name_head)) in (app (app _string_cons _chr_3) (app _fm_comp_hs_name _name_tail)))))))
_fm_comp_hs_native_ops = (let _pairs_0 = (app (app _list_cons (app (app _pair_new "Nat.add") "_nat_add = \\n m-> (n::Integer) + (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.sub") "_nat_sub = \\n m-> max ((n::Integer) - (m::Integer)) 0")) (app (app _list_cons (app (app _pair_new "Nat.mul") "_nat_mul = \\n m-> (n::Integer) * (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.div") "_nat_div = \\n m-> div (n::Integer) (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.div_mod") "_nat_div_mod = \\n m t-> t (div (n::Integer) (m::Integer)) (mod n m)")) (app (app _list_cons (app (app _pair_new "Nat.pow") "_nat_pow = \\n m-> (n::Integer) ^ (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.ltn") "_nat_ltn = \\n m-> (n::Integer) < (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.lte") "_nat_lte = \\n m-> (n::Integer) <= (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.eql") "_nat_eql = \\n m-> (n::Integer) == (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.gte") "_nat_gte = \\n m-> (n::Integer) >= (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.gtn") "_nat_gtn = \\n m-> (n::Integer) > (m::Integer)")) (app (app _list_cons (app (app _pair_new "Nat.to_u16") "_nat_to_u16 = \\n-> (fromInteger (n::Integer)) :: Word16")) (app (app _list_cons (app (app _pair_new "U16.add") "_u16_add = \\n m-> (n::Word16) + (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.sub") "_u16_sub = \\n m-> (n::Word16) - (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.mul") "_u16_add = \\n m-> (n::Word16) + (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.div") "_u16_div = \\n m-> div (n::Word16) (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.mod") "_u16_mod = \\n m-> mod (n::Word16) (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.pow") "_u16_pow = \\n m-> (n::Word16) ^ (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.ltn") "_u16_ltn = \\n m-> (n::Word16) < (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.lte") "_u16_lte = \\n m-> (n::Word16) <= (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.eql") "_u16_eql = \\n m-> (n::Word16) == (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.gte") "_u16_gte = \\n m-> (n::Word16) >= (m::Word16)")) (app (app _list_cons (app (app _pair_new "U16.gtn") "_u16_gtn = \\n m-> (n::Word16) > (m::Word16)")) _list_nil))))))))))))))))))))))) in (let _map_1 = _map_new in (let _map_2 = (app (app (app _list_for _pairs_0) _map_1) (\_pair-> (\_map-> (app _pair (\_pair_fst-> (\_pair_snd-> (app (app (app _fm_set _pair_fst) _pair_snd) _map))))))) in _map_2)))
_fm_comp_ins = (\_prim-> (\_expr-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app (app _ins _prim) _expr))))))))))))))
_fm_comp_lam = (\_name-> (\_body-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app (app _lam _name) _body))))))))))))))
_fm_comp_let = (\_name-> (\_expr-> (\_body-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app (app (app _let _name) _expr) _body)))))))))))))))
_fm_comp_nat = (\_natx-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app _nat _natx)))))))))))))
_fm_comp_nil = (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> _nil)))))))))))
_fm_comp_prims = (app (app _list_cons (app (app _pair_new "Bool.Self") _fm_prim_bool)) (app (app _list_cons (app (app _pair_new "Nat.Self") _fm_prim_nat)) (app (app _list_cons (app (app _pair_new "U16.Self") _fm_prim_u16)) (app (app _list_cons (app (app _pair_new "String.Self") _fm_prim_string)) _list_nil))))
_fm_comp_prim_name = (\_prim-> (app (app (app (app _prim "bool") "nat") "u16") "string"))
_fm_comp_prim_of = (\_type-> (\_defs-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _fm_term_reduce _type) _defs) (\_type_name-> (\_type_indx-> _maybe_none))) (\_type_name-> _maybe_none)) _maybe_none) (\_type_eras-> (\_type_self-> (\_type_name-> (\_type_xtyp-> (\_type_body-> (app (app (app _list_fold _fm_comp_prims) _maybe_none) (\_name_prim-> (\_cont-> (app _name_prim (\_name_prim_fst-> (\_name_prim_snd-> (app (app (_eli_bool (app (app _string_eql _name_prim_fst) _type_self)) (app _maybe_some _name_prim_snd)) _cont))))))))))))) (\_type_name-> (\_type_body-> _maybe_none))) (\_type_func-> (\_type_argm-> _maybe_none))) (\_type_name-> (\_type_expr-> (\_type_body-> _maybe_none)))) (\_type_name-> (\_type_expr-> (\_type_body-> _maybe_none)))) (\_type_done-> (\_type_term-> (\_type_type-> _maybe_none)))) (\_type_name-> (\_type_dref-> (\_type_verb-> _maybe_none)))) (\_type_path-> _maybe_none)) (\_type_natx-> _maybe_none)) (\_type_chrx-> _maybe_none)) (\_type_strx-> _maybe_none)) (\_type_path-> (\_type_expr-> (\_type_name-> (\_type_with-> (\_type_cses-> (\_type_moti-> _maybe_none)))))))))
_fm_comp_ref = (\_name-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app _ref _name)))))))))))))
_fm_comp_str = (\_strx-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app _str _strx)))))))))))))
_fm_comp_var = (\_name-> (\_nil-> (\_var-> (\_ref-> (\_lam-> (\_app-> (\_let-> (\_eli-> (\_ins-> (\_nat-> (\_chr-> (\_str-> (app _var _name)))))))))))))
_fm_constructor = ()
_fm_constructor_build_term = (\_type-> (\_ctor-> (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app _ctor (\_ctor_name-> (\_ctor_args-> (\_ctor_inds-> (app (app (app (app (app _fm_constructor_build_term_go _type) _ctor) _type_name) _type_pars) _ctor_args))))))))))))
_fm_constructor_build_term_go = (\_type-> (\_ctor-> (\_name-> (\_pars-> (\_args-> (app (app _pars (app (app _args (app (app _fm_term_lam (app _fm_name_read "P")) (\_x-> (app (app _fm_constructor_build_term_opt _type) _ctor)))) (\_args_head-> (\_args_tail-> (app _args_head (\_args_head_eras-> (\_args_head_name-> (\_args_head_term-> (app (app _fm_term_lam _args_head_name) (\_x-> (app (app (app (app (app _fm_constructor_build_term_go _type) _ctor) _name) _pars) _args_tail))))))))))) (\_pars_head-> (\_pars_tail-> (app _pars_head (\_pars_head_eras-> (\_pars_head_name-> (\_pars_head_term-> (app (app _fm_term_lam _pars_head_name) (\_x-> (app (app (app (app (app _fm_constructor_build_term_go _type) _ctor) _name) _pars_tail) _args)))))))))))))))
_fm_constructor_build_term_opt = (\_type-> (\_ctor-> (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app (app (app _fm_constructor_build_term_opt_go _type) _ctor) _type_ctrs))))))))
_fm_constructor_build_term_opt_go = (\_type-> (\_ctor-> (\_ctrs-> (app (app _ctrs (app _ctor (\_ctor_name-> (\_ctor_args-> (\_ctor_inds-> (let _ret_6 = (app _fm_term_ref _ctor_name) in (let _ret_7 = (app (app (app _list_for _ctor_args) _ret_6) (\_arg-> (\_ret-> (app (app _fm_term_app _ret) (app _fm_term_ref (app _arg (\_arg_eras-> (\_arg_name-> (\_arg_term-> _arg_name))))))))) in _ret_7))))))) (\_ctrs_head-> (\_ctrs_tail-> (app _ctrs_head (\_ctrs_head_name-> (\_ctrs_head_args-> (\_ctrs_head_inds-> (app (app _fm_term_lam _ctrs_head_name) (\_x-> (app (app (app _fm_constructor_build_term_opt_go _type) _ctor) _ctrs_tail)))))))))))))
_fm_constructor_build_type = (\_type-> (\_ctor-> (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app _ctor (\_ctor_name-> (\_ctor_args-> (\_ctor_inds-> (app (app (app (app (app _fm_constructor_build_type_go _type) _ctor) _type_name) _type_pars) _ctor_args))))))))))))
_fm_constructor_build_type_go = (\_type-> (\_ctor-> (\_name-> (\_pars-> (\_args-> (app (app _pars (app (app _args (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app _ctor (\_ctor_name-> (\_ctor_args-> (\_ctor_inds-> (let _type_12 = (app _fm_term_ref _name) in (let _type_13 = (app (app (app _list_for _type_pars) _type_12) (\_var-> (\_type-> (app (app _fm_term_app _type) (app _fm_term_ref (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_name))))))))) in (let _type_14 = (app (app (app _list_for _ctor_inds) _type_13) (\_var-> (\_type-> (app (app _fm_term_app _type) (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_term)))))))) in _type_14))))))))))))) (\_args_head-> (\_args_tail-> (app _args_head (\_args_head_eras-> (\_args_head_name-> (\_args_head_term-> (app (app (app (app (app _fm_term_all _args_head_eras) "") _args_head_name) _args_head_term) (\_s-> (\_x-> (app (app (app (app (app _fm_constructor_build_type_go _type) _ctor) _name) _pars) _args_tail)))))))))))) (\_pars_head-> (\_pars_tail-> (app _pars_head (\_pars_head_eras-> (\_pars_head_name-> (\_pars_head_term-> (app (app (app (app (app _fm_term_all _pars_head_eras) "") _pars_head_name) _pars_head_term) (\_s-> (\_x-> (app (app (app (app (app _fm_constructor_build_type_go _type) _ctor) _name) _pars_tail) _args))))))))))))))))
_fm_constructor_new = (\_name-> (\_args-> (\_inds-> (\_new-> (app (app (app _new _name) _args) _inds)))))
_fm_context = (app _list (app (app _pair _fm_name) _fm_term))
_fm_context_find = (\_name-> (\_ctx-> (app (app _ctx _maybe_none) (\_ctx_head-> (\_ctx_tail-> (app _ctx_head (\_ctx_head_fst-> (\_ctx_head_snd-> (app (app (_eli_bool (app (app _fm_name_eql _name) _ctx_head_fst)) (app _maybe_some _ctx_head_snd)) (app (app _fm_context_find _name) _ctx_tail))))))))))
_fm_context_names = (\_ctx-> (app (app _list_mapped _ctx) (\_x-> (app _pair_fst _x))))
_fm_context_show = (\_context-> (app (app _context "") (\_context_head-> (\_context_tail-> (app _context_head (\_context_head_fst-> (\_context_head_snd-> (let _name_5 = (app _fm_name_show _context_head_fst) in (let _type_6 = (app _fm_term_show _context_head_snd) in (let _rest_7 = (app _fm_context_show _context_tail) in (app _string_flatten (app (app _list_cons _rest_7) (app (app _list_cons (app (app (_eli_bool (app _string_is_empty _rest_7)) "") "\n")) (app (app _list_cons "- ") (app (app _list_cons _name_5) (app (app _list_cons ": ") (app (app _list_cons _type_6) _list_nil)))))))))))))))))
_fm_datatype = ()
_fm_datatype_build_term = (\_type-> (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app (app (app (app _fm_datatype_build_term_go _type) _type_name) _type_pars) _type_inds)))))))
_fm_datatype_build_term_constructor = (\_type-> (\_ctor-> (app _ctor (\_ctor_name-> (\_ctor_args-> (\_ctor_inds-> (app (app (app _fm_datatype_build_term_constructor_go _type) _ctor) _ctor_args)))))))
_fm_datatype_build_term_constructors = (\_type-> (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app (app (app _fm_datatype_build_term_constructors_go _type) _type_name) _type_ctrs)))))))
_fm_datatype_build_term_constructors_go = (\_type-> (\_name-> (\_ctrs-> (app (app _ctrs (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (let _ret_7 = (app _fm_term_ref (app _fm_name_read "P")) in (let _ret_8 = (app (app (app _list_for _type_inds) _ret_7) (\_var-> (\_ret-> (app (app _fm_term_app _ret) (app _fm_term_ref (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_name))))))))) in (app (app _fm_term_app _ret_8) (app _fm_term_ref (app (app _string_concat _name) ".Self"))))))))))) (\_ctrs_head-> (\_ctrs_tail-> (app _ctrs_head (\_ctrs_head_name-> (\_ctrs_head_args-> (\_ctrs_head_inds-> (app (app (app (app (app _fm_term_all _bool_false) "") _ctrs_head_name) (app (app _fm_datatype_build_term_constructor _type) _ctrs_head)) (\_s-> (\_x-> (app (app (app _fm_datatype_build_term_constructors_go _type) _name) _ctrs_tail))))))))))))))
_fm_datatype_build_term_constructor_go = (\_type-> (\_ctor-> (\_args-> (app (app _args (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app _ctor (\_ctor_name-> (\_ctor_args-> (\_ctor_inds-> (let _ret_10 = (app _fm_term_ref (app _fm_name_read "P")) in (let _ret_11 = (app (app (app _list_for _ctor_inds) _ret_10) (\_var-> (\_ret-> (app (app _fm_term_app _ret) (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_term)))))))) in (let _ctr_12 = (app _string_flatten (app (app _list_cons _type_name) (app (app _list_cons (app _fm_name_read ".")) (app (app _list_cons _ctor_name) _list_nil)))) in (let _slf_13 = (app _fm_term_ref _ctr_12) in (let _slf_14 = (app (app (app _list_for _type_pars) _slf_13) (\_var-> (\_slf-> (app (app _fm_term_app _slf) (app _fm_term_ref (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_name))))))))) in (let _slf_15 = (app (app (app _list_for _ctor_args) _slf_14) (\_var-> (\_slf-> (app (app _fm_term_app _slf) (app _fm_term_ref (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_name))))))))) in (app (app _fm_term_app _ret_11) _slf_15))))))))))))))))) (\_args_head-> (\_args_tail-> (app _args_head (\_args_head_eras-> (\_args_head_name-> (\_args_head_term-> (let _eras_8 = _args_head_eras in (let _name_9 = _args_head_name in (let _xtyp_10 = _args_head_term in (let _body_11 = (app (app (app _fm_datatype_build_term_constructor_go _type) _ctor) _args_tail) in (app (app (app (app (app _fm_term_all _eras_8) "") _name_9) _xtyp_10) (\_s-> (\_x-> _body_11)))))))))))))))))
_fm_datatype_build_term_go = (\_type-> (\_name-> (\_pars-> (\_inds-> (app (app _pars (app (app _inds (app (app (app (app (app _fm_term_all _bool_true) (app (app _string_concat _name) ".Self")) (app _fm_name_read "P")) (app _fm_datatype_build_term_motive _type)) (\_s-> (\_x-> (app _fm_datatype_build_term_constructors _type))))) (\_inds_head-> (\_inds_tail-> (app _inds_head (\_inds_head_eras-> (\_inds_head_name-> (\_inds_head_term-> (app (app _fm_term_lam _inds_head_name) (\_x-> (app (app (app (app _fm_datatype_build_term_go _type) _name) _pars) _inds_tail))))))))))) (\_pars_head-> (\_pars_tail-> (app _pars_head (\_pars_head_eras-> (\_pars_head_name-> (\_pars_head_term-> (app (app _fm_term_lam _pars_head_name) (\_x-> (app (app (app (app _fm_datatype_build_term_go _type) _name) _pars_tail) _inds))))))))))))))
_fm_datatype_build_term_motive = (\_type-> (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app (app (app _fm_datatype_build_term_motive_go _type) _type_name) _type_inds)))))))
_fm_datatype_build_term_motive_go = (\_type-> (\_name-> (\_inds-> (app (app _inds (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (let _slf_7 = (app _fm_term_ref _name) in (let _slf_8 = (app (app (app _list_for _type_pars) _slf_7) (\_var-> (\_slf-> (app (app _fm_term_app _slf) (app _fm_term_ref (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_name))))))))) in (let _slf_9 = (app (app (app _list_for _type_inds) _slf_8) (\_var-> (\_slf-> (app (app _fm_term_app _slf) (app _fm_term_ref (app _var (\_var_eras-> (\_var_name-> (\_var_term-> _var_name))))))))) in (app (app (app (app (app _fm_term_all _bool_false) "") (app _fm_name_read "self")) _slf_9) (\_s-> (\_x-> _fm_term_typ)))))))))))) (\_inds_head-> (\_inds_tail-> (app _inds_head (\_inds_head_eras-> (\_inds_head_name-> (\_inds_head_term-> (app (app (app (app (app _fm_term_all _inds_head_eras) "") _inds_head_name) _inds_head_term) (\_s-> (\_x-> (app (app (app _fm_datatype_build_term_motive_go _type) _name) _inds_tail))))))))))))))
_fm_datatype_build_type = (\_type-> (app _type (\_type_name-> (\_type_pars-> (\_type_inds-> (\_type_ctrs-> (app (app (app (app _fm_datatype_build_type_go _type) _type_name) _type_pars) _type_inds)))))))
_fm_datatype_build_type_go = (\_type-> (\_name-> (\_pars-> (\_inds-> (app (app _pars (app (app _inds _fm_term_typ) (\_inds_head-> (\_inds_tail-> (app _inds_head (\_inds_head_eras-> (\_inds_head_name-> (\_inds_head_term-> (app (app (app (app (app _fm_term_all _bool_false) "") _inds_head_name) _inds_head_term) (\_s-> (\_x-> (app (app (app (app _fm_datatype_build_type_go _type) _name) _pars) _inds_tail)))))))))))) (\_pars_head-> (\_pars_tail-> (app _pars_head (\_pars_head_eras-> (\_pars_head_name-> (\_pars_head_term-> (app (app (app (app (app _fm_term_all _bool_false) "") _pars_head_name) _pars_head_term) (\_s-> (\_x-> (app (app (app (app _fm_datatype_build_type_go _type) _name) _pars_tail) _inds)))))))))))))))
_fm_datatype_new = (\_name-> (\_pars-> (\_inds-> (\_ctrs-> (\_new-> (app (app (app (app _new _name) _pars) _inds) _ctrs))))))
_fm_def = ()
_fm_defs = (app _map _fm_def)
_fm_defs_read = (\_code-> (app (app (app _fm_parser_file _code) (\_parsed_code-> (\_parsed_err-> _maybe_none))) (\_parsed_code-> (\_parsed_val-> (app _maybe_some _parsed_val)))))
_fm_defs_show = (\_defs-> (let _str_1 = "" in (let _str_2 = (app (app (app _list_for (app _map_to_list _defs)) _str_1) (\_name_def-> (\_str-> (app _name_def (\_name_def_fst-> (\_name_def_snd-> (app _name_def_snd (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> (app _string_flatten (app (app _list_cons _str) (app (app _list_cons (app _fm_name_show _def_name)) (app (app _list_cons ": ") (app (app _list_cons (app _fm_term_show _def_type)) (app (app _list_cons "\n  ") (app (app _list_cons (app _fm_term_show _def_term)) (app (app _list_cons "\n") _list_nil))))))))))))))))))) in _str_2)))
_fm_def_new = (\_name-> (\_term-> (\_type-> (\_done-> (\_new-> (app (app (app (app _new _name) _term) _type) _done))))))
_fm_error = ()
_fm_error_cant_infer = (\_term-> (\_context-> (\_type_mismatch-> (\_show_goal-> (\_patch-> (\_undefined_reference-> (\_cant_infer-> (app (app _cant_infer _term) _context))))))))
_fm_error_patch = (\_path-> (\_term-> (\_type_mismatch-> (\_show_goal-> (\_patch-> (\_undefined_reference-> (\_cant_infer-> (app (app _patch _path) _term))))))))
_fm_error_show = (\_error-> (\_defs-> (app (app (app (app (app _error (\_error_expected-> (\_error_detected-> (\_error_context-> (let _expected_5 = (app (app _error_expected (\_error_expected_value-> _error_expected_value)) (\_error_expected_value-> (app _fm_term_show (app (app _fm_term_normalize _error_expected_value) _map_new)))) in (let _detected_6 = (app (app _error_detected (\_error_detected_value-> _error_detected_value)) (\_error_detected_value-> (app _fm_term_show (app (app _fm_term_normalize _error_detected_value) _map_new)))) in (let _context_7 = (app _fm_context_show _error_context) in (app _string_flatten (app (app _list_cons "Type mismatch.\n") (app (app _list_cons "- Expected: ") (app (app _list_cons _expected_5) (app (app _list_cons "\n") (app (app _list_cons "- Detected: ") (app (app _list_cons _detected_6) (app (app _list_cons "\n") (app (app _list_cons "With context:\n") (app (app _list_cons _context_7) _list_nil))))))))))))))))) (\_error_name-> (\_error_dref-> (\_error_verb-> (\_error_goal-> (\_error_context-> (let _goal_name_7 = (app _string_flatten (app (app _list_cons "Goal ?") (app (app _list_cons (app _fm_name_show _error_name)) (app (app _list_cons ":\n") _list_nil)))) in (let _with_type_8 = (app (app _error_goal "") (\_error_goal_value-> (let _goal_9 = (app (app (app _fm_term_expand _error_dref) _error_goal_value) _defs) in (app _string_flatten (app (app _list_cons "With type: ") (app (app _list_cons (app (app (_eli_bool _error_verb) (app (app _fm_term_show_go _goal_9) (app _maybe_some (\_x-> _x)))) (app _fm_term_show _goal_9))) (app (app _list_cons "\n") _list_nil))))))) in (let _with_ctxt_9 = (app _string_flatten (app (app _list_cons "With ctxt:\n") (app (app _list_cons (app _fm_context_show _error_context)) _list_nil))) in (app _string_flatten (app (app _list_cons _goal_name_7) (app (app _list_cons _with_type_8) (app (app _list_cons _with_ctxt_9) _list_nil))))))))))))) (\_error_path-> (\_error_term-> (app _string_flatten (app (app _list_cons "Patching: ") (app (app _list_cons (app _fm_term_show _error_term)) _list_nil)))))) (\_error_name-> (app _string_flatten (app (app _list_cons "Undefined reference: ") (app (app _list_cons (app _fm_name_show _error_name)) _list_nil))))) (\_error_term-> (\_error_context-> (let _term_4 = (app _fm_term_show _error_term) in (let _context_5 = (app _fm_context_show _error_context) in (app _string_flatten (app (app _list_cons "Can\'t infer type of: ") (app (app _list_cons _term_4) (app (app _list_cons "\n") (app (app _list_cons "With ctxt:\n") (app (app _list_cons _context_5) _list_nil)))))))))))))
_fm_error_show_goal = (\_name-> (\_dref-> (\_verb-> (\_goal-> (\_context-> (\_type_mismatch-> (\_show_goal-> (\_patch-> (\_undefined_reference-> (\_cant_infer-> (app (app (app (app (app _show_goal _name) _dref) _verb) _goal) _context)))))))))))
_fm_error_type_mismatch = (\_expected-> (\_detected-> (\_context-> (\_type_mismatch-> (\_show_goal-> (\_patch-> (\_undefined_reference-> (\_cant_infer-> (app (app (app _type_mismatch _expected) _detected) _context)))))))))
_fm_error_undefined_reference = (\_name-> (\_type_mismatch-> (\_show_goal-> (\_patch-> (\_undefined_reference-> (\_cant_infer-> (app _undefined_reference _name)))))))
_fm_letter = _char
_fm_mpath = (app _maybe _fm_path)
_fm_mpath_nil = (app _maybe_some _fm_path_nil)
_fm_mpath_to_bits = (\_path-> (app (app _path _bits_nil) (\_path_value-> (app _path_value _bits_nil))))
_fm_mpath_0 = (\_path-> (app (app _maybe_mapped _path) _fm_path_0))
_fm_mpath_1 = (\_path-> (app (app _maybe_mapped _path) _fm_path_1))
_fm_name = _string
_fm_name_eql = (\_a-> (\_b-> (app (app _string_eql _a) _b)))
_fm_name_from_bits = (\_bits-> (let _list_1 = (app (app _bits_chunks_of (6::Integer)) _bits) in (let _name_2 = (app (app (app _list_fold _list_1) _string_nil) (\_bts-> (\_name-> (let _u16_4 = (app _u16_new (app (app _word_from_bits (16::Integer)) (app _bits_reverse _bts))) in (let _chr_5 = (app (app (_eli_bool (app (app (app _u16_btw (app _nat_to_u16 (0::Integer))) _u16_4) (app _nat_to_u16 (25::Integer)))) (app (app _u16_add _u16_4) (app _nat_to_u16 (65::Integer)))) (app (app (_eli_bool (app (app (app _u16_btw (app _nat_to_u16 (26::Integer))) _u16_4) (app _nat_to_u16 (51::Integer)))) (app (app _u16_add _u16_4) (app _nat_to_u16 (71::Integer)))) (app (app (_eli_bool (app (app (app _u16_btw (app _nat_to_u16 (52::Integer))) _u16_4) (app _nat_to_u16 (61::Integer)))) (app (app _u16_sub _u16_4) (app _nat_to_u16 (4::Integer)))) (app (app (_eli_bool (app (app _u16_eql (app _nat_to_u16 (62::Integer))) _u16_4)) (app _nat_to_u16 (46::Integer))) (app _nat_to_u16 (95::Integer)))))) in (app (app _string_cons _chr_5) _name)))))) in _name_2)))
_fm_name_is_letter = (\_chr-> (app (app (_eli_bool (app (app (app _u16_btw (65::Word16)) _chr) (90::Word16))) _bool_true) (app (app (_eli_bool (app (app (app _u16_btw (97::Word16)) _chr) (122::Word16))) _bool_true) (app (app (_eli_bool (app (app (app _u16_btw (48::Word16)) _chr) (57::Word16))) _bool_true) (app (app (_eli_bool (app (app _u16_eql (46::Word16)) _chr)) _bool_true) (app (app (_eli_bool (app (app _u16_eql (95::Word16)) _chr)) _bool_true) _bool_false))))))
_fm_name_read = (\_str-> _str)
_fm_name_show = (\_name-> _name)
_fm_name_to_bits = (\_name-> (app (app (_eli_string _name) _bits_nil) (\_name_head-> (\_name_tail-> (let _chr_3 = _name_head in (let _u16_4 = (app (app (_eli_bool (app (app (app _u16_btw (65::Word16)) _chr_3) (90::Word16))) (app (app _u16_sub _chr_3) (app _nat_to_u16 (65::Integer)))) (app (app (_eli_bool (app (app (app _u16_btw (97::Word16)) _chr_3) (122::Word16))) (app (app _u16_sub _chr_3) (app _nat_to_u16 (71::Integer)))) (app (app (_eli_bool (app (app (app _u16_btw (48::Word16)) _chr_3) (57::Word16))) (app (app _u16_add _chr_3) (app _nat_to_u16 (4::Integer)))) (app (app (_eli_bool (app (app _u16_eql (46::Word16)) _chr_3)) (app _nat_to_u16 (62::Integer))) (app (app (_eli_bool (app (app _u16_eql (95::Word16)) _chr_3)) (app _nat_to_u16 (63::Integer))) (app _nat_to_u16 (0::Integer))))))) in (let _bts_5 = (app (_eli_u16 _u16_4) (\_u16_value-> (app _word_to_bits (app (app _word_trim (6::Integer)) _u16_value)))) in (app (app _bits_concat (app _bits_reverse _bts_5)) (app _fm_name_to_bits _name_tail)))))))))
_fm_parser_annotation = (\_term-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "::")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_type-> (app (app _monad_pure _parser_monad) (app (app (app _fm_term_ann _bool_false) _term) _type)))))))
_fm_parser_application = (\_func-> (app (app (app _monad_bind _parser_monad) (app _parser_first_of (app (app _list_cons (app _parser_text "(")) (app (app _list_cons (app _parser_text "<")) _list_nil)))) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_many1 (app _fm_parser_item _fm_parser_term))) (\_args-> (app (app (app _monad_bind _parser_monad) (app _parser_first_of (app (app _list_cons (app _parser_spaces_text ")")) (app (app _list_cons (app _parser_spaces_text ">")) _list_nil)))) (\_-> (app (app _monad_pure _parser_monad) (app (app (app _list_for _args) _func) (\_x-> (\_f-> (app (app _fm_term_app _f) _x))))))))))))
_fm_parser_arrow = (\_xtyp-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "->")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_body-> (app (app _monad_pure _parser_monad) (app (app (app (app (app _fm_term_all _bool_false) "") "") _xtyp) (\_s-> (\_x-> _body)))))))))
_fm_parser_binder = (app (app (app _monad_bind _parser_monad) (app _parser_many1 (app _parser_first_of (app (app _list_cons (app _fm_parser_binder_homo _bool_true)) (app (app _list_cons (app _fm_parser_binder_homo _bool_false)) _list_nil))))) (\_lists-> (app (app _monad_pure _parser_monad) (app _list_flatten _lists))))
_fm_parser_binder_homo = (\_eras-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text (app (app (_eli_bool _eras) "<") "("))) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_many1 (app _fm_parser_item _fm_parser_name_term))) (\_bind-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text (app (app (_eli_bool _eras) ">") ")"))) (\_-> (app (app _monad_pure _parser_monad) (app (app _list_mapped _bind) (\_pair-> (app _pair (\_pair_fst-> (\_pair_snd-> (app (app (app _fm_binder_new _eras) _pair_fst) _pair_snd))))))))))))))
_fm_parser_case = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "case ")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "as")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> _fm_parser_name1)))))) (\_name-> (let _name_4 = (app (app _name (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _expr (\_expr_name-> (\_expr_indx-> _expr_name))) (\_expr_name-> _expr_name)) (app _fm_name_read "self")) (\_expr_eras-> (\_expr_self-> (\_expr_name-> (\_expr_xtyp-> (\_expr_body-> (app _fm_name_read "self"))))))) (\_expr_name-> (\_expr_body-> (app _fm_name_read "self")))) (\_expr_func-> (\_expr_argm-> (app _fm_name_read "self")))) (\_expr_name-> (\_expr_expr-> (\_expr_body-> (app _fm_name_read "self"))))) (\_expr_name-> (\_expr_expr-> (\_expr_body-> (app _fm_name_read "self"))))) (\_expr_done-> (\_expr_term-> (\_expr_type-> (app _fm_name_read "self"))))) (\_expr_name-> (\_expr_dref-> (\_expr_verb-> (app _fm_name_read "self"))))) (\_expr_path-> (app _fm_name_read "self"))) (\_expr_natx-> (app _fm_name_read "self"))) (\_expr_chrx-> (app _fm_name_read "self"))) (\_expr_strx-> (app _fm_name_read "self"))) (\_expr_path-> (\_expr_expr-> (\_expr_name-> (\_expr_with-> (\_expr_cses-> (\_expr_moti-> (app _fm_name_read "self"))))))))) (\_name_value-> _name_value)) in (app (app (app _monad_bind _parser_monad) (app _parser_many _fm_parser_case_with)) (\_with-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "{")) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_many _fm_parser_case_case)) (\_cses-> (let _cses_8 = (app (app _map_from_list _fm_name_to_bits) _cses) in (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "}")) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text ":")) (\_-> _fm_parser_term)))) (\_moti-> (let _moti_11 = (app (app _moti (app _fm_term_hol _bits_nil)) (\_moti_value-> _moti_value)) in (app (app _monad_pure _parser_monad) (app (app (app (app (app (app _fm_term_cse _bits_nil) _expr) _name_4) _with) _cses_8) _moti_11)))))))))))))))))))))))
_fm_parser_case_case = (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text ":")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_term-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app _fm_parser_spaces_text ","))) (\_-> (app (app _monad_pure _parser_monad) (app (app _pair_new _name) _term))))))))))))
_fm_parser_case_with = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "with")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text ":")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_type-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "=")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_term-> (app (app _monad_pure _parser_monad) (app (app (app (app _fm_def_new _name) _term) _type) _bool_false))))))))))))))))
_fm_parser_char = (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "\'")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_char_single) (\_chrx-> (app (app (app _monad_bind _parser_monad) (app _parser_text "\'")) (\_-> (app (app _monad_pure _parser_monad) (app _fm_term_chr _chrx))))))))
_fm_parser_char_single = (app _parser_first_of (app (app _list_cons (app _parser_first_of (app (app _list_mapped _fm_escapes) (\_esc-> (app _esc (\_esc_fst-> (\_esc_snd-> (app (app (app _monad_bind _parser_monad) (app _parser_text _esc_fst)) (\_-> (app (app _monad_pure _parser_monad) _esc_snd)))))))))) (app (app _list_cons _parser_one) _list_nil)))
_fm_parser_constructor = (\_namespace-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe _fm_parser_binder)) (\_args-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "~")) (\_-> _fm_parser_binder)))) (\_inds-> (let _args_4 = (app (app _maybe_default _list_nil) _args) in (let _inds_5 = (app (app _maybe_default _list_nil) _inds) in (app (app _monad_pure _parser_monad) (app (app (app _fm_constructor_new _name) _args_4) _inds_5)))))))))))
_fm_parser_datatype = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "type ")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe _fm_parser_binder)) (\_pars-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "~")) (\_-> _fm_parser_binder)))) (\_inds-> (let _pars_4 = (app (app _maybe_default _list_nil) _pars) in (let _inds_5 = (app (app _maybe_default _list_nil) _inds) in (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "{")) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_many (app _fm_parser_item (app _fm_parser_constructor _name)))) (\_ctrs-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "}")) (\_-> (app (app _monad_pure _parser_monad) (app (app (app (app _fm_datatype_new _name) _pars_4) _inds_5) _ctrs))))))))))))))))))
_fm_parser_def = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "def ")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name) (\_name-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "=")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app _fm_parser_spaces_text ";"))) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_body-> (app (app _monad_pure _parser_monad) (app (app (app _fm_term_def _name) _expr) (\_x-> _body)))))))))))))))))
_fm_parser_definition = (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_many _fm_parser_binder)) (\_args-> (let _args_3 = (app _list_flatten _args) in (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text ":")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_type-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_term-> (let _type_7 = (app (app _fm_parser_make_forall _args_3) _type) in (let _term_8 = (app (app _fm_parser_make_lambda (app (app _list_mapped _args_3) (\_x-> (app _x (\_x_eras-> (\_x_name-> (\_x_term-> _x_name))))))) _term) in (let _type_9 = (app (app (app _fm_term_bind _list_nil) (\_x-> (app _bits_1 _x))) _type_7) in (let _term_10 = (app (app (app _fm_term_bind _list_nil) (\_x-> (app _bits_0 _x))) _term_8) in (app (app _monad_pure _parser_monad) (app (app _debug_log (app (app _string_concat "parse ") _name)) (\_x-> (app (app (app (app _fm_def_new _name) _term_10) _type_9) _bool_false)))))))))))))))))))))
_fm_parser_do = (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "do ")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "{")) (\_-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_do_statements _name)) (\_term-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "}")) (\_-> (app (app _monad_pure _parser_monad) _term)))))))))))))
_fm_parser_do_statements = (\_monad_name-> (app _parser_first_of (app (app _list_cons (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "var ")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "=")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ";")) (\_-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_do_statements _monad_name)) (\_body-> (let _term_8 = (app (app _fm_term_app (app _fm_term_ref "Monad.bind")) (app _fm_term_ref _monad_name)) in (let _term_9 = (app (app _fm_term_app _term_8) (app _fm_term_ref (app (app _string_concat _monad_name) ".monad"))) in (let _term_10 = (app (app _fm_term_app _term_9) (app _fm_term_hol _bits_nil)) in (let _term_11 = (app (app _fm_term_app _term_10) (app _fm_term_hol _bits_nil)) in (let _term_12 = (app (app _fm_term_app _term_11) _expr) in (let _term_13 = (app (app _fm_term_app _term_12) (app (app _fm_term_lam _name) (\_x-> _body))) in (app (app _monad_pure _parser_monad) _term_13)))))))))))))))))))))) (app (app _list_cons (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "let ")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "=")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ";")) (\_-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_do_statements _monad_name)) (\_body-> (app (app _monad_pure _parser_monad) (app (app (app _fm_term_let _name) _expr) (\_x-> _body)))))))))))))))))) (app (app _list_cons (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "return ")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ";")) (\_-> (let _term_4 = (app (app _fm_term_app (app _fm_term_ref "Monad.pure")) (app _fm_term_ref _monad_name)) in (let _term_5 = (app (app _fm_term_app _term_4) (app _fm_term_ref (app (app _string_concat _monad_name) ".monad"))) in (let _term_6 = (app (app _fm_term_app _term_5) (app _fm_term_hol _bits_nil)) in (let _term_7 = (app (app _fm_term_app _term_6) _expr) in (app (app _monad_pure _parser_monad) _term_7)))))))))))) (app (app _list_cons (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ";")) (\_-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_do_statements _monad_name)) (\_body-> (let _term_4 = (app (app _fm_term_app (app _fm_term_ref "Monad.bind")) (app _fm_term_ref _monad_name)) in (let _term_5 = (app (app _fm_term_app _term_4) (app _fm_term_ref (app (app _string_concat _monad_name) ".monad"))) in (let _term_6 = (app (app _fm_term_app _term_5) (app _fm_term_hol _bits_nil)) in (let _term_7 = (app (app _fm_term_app _term_6) (app _fm_term_hol _bits_nil)) in (let _term_8 = (app (app _fm_term_app _term_7) _expr) in (let _term_9 = (app (app _fm_term_app _term_8) (app (app _fm_term_lam "") (\_x-> _body))) in (app (app _monad_pure _parser_monad) _term_9)))))))))))))) (app (app _list_cons (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ";")) (\_-> (app (app _monad_pure _parser_monad) _expr)))))) _list_nil)))))))
_fm_parser_file = (app _fm_parser_file_go _map_new)
_fm_parser_file_go = (\_defs-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe _fm_parser_definition)) (\_def-> (app (app _def (app (app (app _monad_bind _parser_monad) (app _parser_maybe _fm_parser_datatype)) (\_adt-> (app (app _adt (app (app _monad_pure _parser_monad) _defs)) (\_adt_value-> (app _adt_value (\_adt_value_name-> (\_adt_value_pars-> (\_adt_value_inds-> (\_adt_value_ctrs-> (let _term_8 = (app _fm_datatype_build_term _adt_value) in (let _term_9 = (app (app (app _fm_term_bind _list_nil) (\_x-> (app _bits_1 _x))) _term_8) in (let _type_10 = (app _fm_datatype_build_type _adt_value) in (let _type_11 = (app (app (app _fm_term_bind _list_nil) (\_x-> (app _bits_0 _x))) _type_10) in (let _defs_12 = (app (app (app _fm_set _adt_value_name) (app (app (app (app _fm_def_new _adt_value_name) _term_9) _type_11) _bool_false)) _defs) in (let _defs_13 = (app (app (app _list_fold _adt_value_ctrs) _defs_12) (\_ctr-> (\_defs-> (let _typ_name_15 = _adt_value_name in (let _ctr_name_16 = (app _string_flatten (app (app _list_cons _typ_name_15) (app (app _list_cons (app _fm_name_read ".")) (app (app _list_cons (app _ctr (\_ctr_name-> (\_ctr_args-> (\_ctr_inds-> _ctr_name))))) _list_nil)))) in (let _ctr_term_17 = (app (app _fm_constructor_build_term _adt_value) _ctr) in (let _ctr_term_18 = (app (app (app _fm_term_bind _list_nil) (\_x-> (app _bits_1 _x))) _ctr_term_17) in (let _ctr_type_19 = (app (app _fm_constructor_build_type _adt_value) _ctr) in (let _ctr_type_20 = (app (app (app _fm_term_bind _list_nil) (\_x-> (app _bits_0 _x))) _ctr_type_19) in (app (app (app _fm_set _ctr_name_16) (app (app (app (app _fm_def_new _ctr_name_16) _ctr_term_18) _ctr_type_20) _bool_false)) _defs)))))))))) in (app _fm_parser_file_go _defs_13))))))))))))))))) (\_def_value-> (app _def_value (\_def_value_name-> (\_def_value_term-> (\_def_value_type-> (\_def_value_done-> (app _fm_parser_file_go (app (app (app _fm_set _def_value_name) _def_value) _defs))))))))))))
_fm_parser_forall = (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name) (\_self-> (app (app (app _monad_bind _parser_monad) _fm_parser_binder) (\_bind-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app _parser_spaces_text "->"))) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_body-> (let _term_5 = (app (app (app _list_fold _bind) _body) (\_x-> (\_t-> (app _x (\_x_eras-> (\_x_name-> (\_x_term-> (app (app (app (app (app _fm_term_all _x_eras) "") _x_name) _x_term) (\_s-> (\_x-> _t)))))))))) in (app (app _monad_pure _parser_monad) (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term_5 (\_term_name-> (\_term_indx-> _term_5))) (\_term_name-> _term_5)) _term_5) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (app (app (app (app (app _fm_term_all _term_eras) _self) _term_name) _term_xtyp) _term_body))))))) (\_term_name-> (\_term_body-> _term_5))) (\_term_func-> (\_term_argm-> _term_5))) (\_term_name-> (\_term_expr-> (\_term_body-> _term_5)))) (\_term_name-> (\_term_expr-> (\_term_body-> _term_5)))) (\_term_done-> (\_term_term-> (\_term_type-> _term_5)))) (\_term_name-> (\_term_dref-> (\_term_verb-> _term_5)))) (\_term_path-> _term_5)) (\_term_natx-> _term_5)) (\_term_chrx-> _term_5)) (\_term_strx-> _term_5)) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> _term_5)))))))))))))))))))
_fm_parser_forin = (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "for ")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_elem-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "in")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_list-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "with")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ":")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_loop-> (let _term_11 = (app _fm_term_ref "List.for") in (let _term_12 = (app (app _fm_term_app _term_11) (app _fm_term_hol _bits_nil)) in (let _term_13 = (app (app _fm_term_app _term_12) _list) in (let _term_14 = (app (app _fm_term_app _term_13) (app _fm_term_hol _bits_nil)) in (let _term_15 = (app (app _fm_term_app _term_14) (app _fm_term_ref _name)) in (let _lamb_16 = (app (app _fm_term_lam _elem) (\_i-> (app (app _fm_term_lam _name) (\_x-> _loop)))) in (let _term_17 = (app (app _fm_term_app _term_15) _lamb_16) in (let _term_18 = (app (app (app _fm_term_let _name) _term_17) (\_x-> (app _fm_term_ref _name))) in (app (app _monad_pure _parser_monad) _term_18)))))))))))))))))))))))))))))))
_fm_parser_goal = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "?")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_many (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "-")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_nat) (\_nat-> (let _bits_4 = (app _bits_reverse (app _bits_tail (app _bits_reverse (app _nat_to_bits _nat)))) in (app (app _monad_pure _parser_monad) _bits_4)))))))) (\_dref-> (app (app (app _monad_bind _parser_monad) (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app _parser_text "-"))) (\_verb-> (app (app _monad_pure _parser_monad) (app _maybe_to_bool _verb))))) (\_verb-> (app (app _monad_pure _parser_monad) (app (app (app _fm_term_gol _name) _dref) _verb))))))))))
_fm_parser_hole = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "_")) (\_-> (app (app _monad_pure _parser_monad) (app _fm_term_hol _bits_nil))))
_fm_parser_if = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "if ")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_cond-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "then")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_tcse-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "else")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_fcse-> (let _term_6 = _cond in (let _term_7 = (app (app _fm_term_app _term_6) (app (app _fm_term_lam "") (\_x-> (app _fm_term_hol _bits_nil)))) in (let _term_8 = (app (app _fm_term_app _term_7) _tcse) in (let _term_9 = (app (app _fm_term_app _term_8) _fcse) in (app (app _monad_pure _parser_monad) _term_9)))))))))))))))))
_fm_parser_item = (\_parser-> (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _parser) (\_value-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app _fm_parser_spaces_text ","))) (\_-> (app (app _monad_pure _parser_monad) _value))))))))
_fm_parser_lambda = (app (app (app _monad_bind _parser_monad) (app _parser_first_of (app (app _list_cons (app _parser_spaces_text "(")) (app (app _list_cons (app _parser_spaces_text "<")) _list_nil)))) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_many1 (app _fm_parser_item _fm_parser_name1))) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_first_of (app (app _list_cons (app _parser_text ")")) (app (app _list_cons (app _parser_text ">")) _list_nil)))) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_body-> (app (app _monad_pure _parser_monad) (app (app _fm_parser_make_lambda _name) _body))))))))))
_fm_parser_let = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "let ")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name) (\_name-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "=")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_expr-> (app (app (app _monad_bind _parser_monad) (app _parser_maybe (app _fm_parser_spaces_text ";"))) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_body-> (app (app _monad_pure _parser_monad) (app (app (app _fm_term_let _name) _expr) (\_x-> _body)))))))))))))))))
_fm_parser_letforin = (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "let ")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "=")) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "for ")) (\_-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_elem-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "in")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_list-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ":")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_loop-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ";")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_body-> (let _term_13 = (app _fm_term_ref "List.for") in (let _term_14 = (app (app _fm_term_app _term_13) (app _fm_term_hol _bits_nil)) in (let _term_15 = (app (app _fm_term_app _term_14) _list) in (let _term_16 = (app (app _fm_term_app _term_15) (app _fm_term_hol _bits_nil)) in (let _term_17 = (app (app _fm_term_app _term_16) (app _fm_term_ref _name)) in (let _lamb_18 = (app (app _fm_term_lam _elem) (\_i-> (app (app _fm_term_lam _name) (\_x-> _loop)))) in (let _term_19 = (app (app _fm_term_app _term_17) _lamb_18) in (let _term_20 = (app (app (app _fm_term_let _name) _term_19) (\_x-> _body)) in (app (app _monad_pure _parser_monad) _term_20)))))))))))))))))))))))))))))))))))
_fm_parser_letter = (\_code-> (app (app (_eli_string _code) (app (app _parser_reply_error _code) "Unexpected eof.")) (\_code_head-> (\_code_tail-> (app (app (_eli_bool (app _fm_name_is_letter _code_head)) (app (app _parser_reply_value _code_tail) _code_head)) (app (app _parser_reply_error _code) "Expected letter."))))))
_fm_parser_list = (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "[")) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_many (app _fm_parser_item _fm_parser_term))) (\_vals-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "]")) (\_-> (app (app _monad_pure _parser_monad) (app (app (app _list_fold _vals) (app (app _fm_term_app (app _fm_term_ref (app _fm_name_read "List.nil"))) (app _fm_term_hol _bits_nil))) (\_x-> (\_xs-> (let _term_5 = (app _fm_term_ref (app _fm_name_read "List.cons")) in (let _term_6 = (app (app _fm_term_app _term_5) (app _fm_term_hol _bits_nil)) in (let _term_7 = (app (app _fm_term_app _term_6) _x) in (let _term_8 = (app (app _fm_term_app _term_7) _xs) in _term_8))))))))))))))
_fm_parser_make_forall = (\_binds-> (\_body-> (app (app _binds _body) (\_binds_head-> (\_binds_tail-> (app _binds_head (\_binds_head_eras-> (\_binds_head_name-> (\_binds_head_term-> (app (app (app (app (app _fm_term_all _binds_head_eras) "") _binds_head_name) _binds_head_term) (\_s-> (\_x-> (app (app _fm_parser_make_forall _binds_tail) _body)))))))))))))
_fm_parser_make_lambda = (\_names-> (\_body-> (app (app _names _body) (\_names_head-> (\_names_tail-> (app (app _fm_term_lam _names_head) (\_x-> (app (app _fm_parser_make_lambda _names_tail) _body))))))))
_fm_parser_name = (app (app (app _monad_bind _parser_monad) (app _parser_many _fm_parser_letter)) (\_chrs-> (app (app _monad_pure _parser_monad) (app (app (app _list_fold _chrs) _string_nil) _string_cons))))
_fm_parser_name1 = (app (app (app _monad_bind _parser_monad) (app _parser_many1 _fm_parser_letter)) (\_chrs-> (app (app _monad_pure _parser_monad) (app (app (app _list_fold _chrs) _string_nil) _string_cons))))
_fm_parser_name_term = (app (app (app _monad_bind _parser_monad) _fm_parser_name) (\_name-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text ":")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_type-> (app (app _monad_pure _parser_monad) (app (app _pair_new _name) _type))))))))
_fm_parser_nat = (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _parser_nat) (\_natx-> (app (app _monad_pure _parser_monad) (app _fm_term_nat _natx))))))
_fm_parser_pair = (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "{")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_val0-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text ",")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_val1-> (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text "}")) (\_-> (let _term_5 = (app _fm_term_ref "Pair.new") in (let _term_6 = (app (app _fm_term_app _term_5) (app _fm_term_hol _bits_nil)) in (let _term_7 = (app (app _fm_term_app _term_6) (app _fm_term_hol _bits_nil)) in (let _term_8 = (app (app _fm_term_app _term_7) _val0) in (let _term_9 = (app (app _fm_term_app _term_8) _val1) in (app (app _monad_pure _parser_monad) _term_9))))))))))))))))
_fm_parser_parenthesis = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "(")) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_term) (\_term-> (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text ")")) (\_-> (app (app _monad_pure _parser_monad) _term)))))))
_fm_parser_reference = (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app (app (app _monad_bind _parser_monad) _fm_parser_name1) (\_name-> (app (app _monad_pure _parser_monad) (app _fm_term_ref _name))))))
_fm_parser_spaces = (app _parser_many (app _parser_first_of (app (app _list_cons (app _parser_text " ")) (app (app _list_cons (app _parser_text "\n")) (app (app _list_cons (app (app (app _monad_bind _parser_monad) (app _parser_text "//")) (\_-> (app (app (app _monad_bind _parser_monad) (app _parser_many (app _parser_char_if (\_chr-> (app _bool_not (app (app _u16_eql _chr) (10::Word16))))))) (\_-> (app _parser_text "\n")))))) _list_nil)))))
_fm_parser_spaces_text = (\_text-> (app (app (app _monad_bind _parser_monad) _fm_parser_spaces) (\_-> (app _parser_text _text))))
_fm_parser_string = (let _quot_0 = (app (app _string_cons (34::Word16)) _string_nil) in (app (app (app _monad_bind _parser_monad) (app _parser_spaces_text _quot_0)) (\_-> (app (app (app _monad_bind _parser_monad) (app (app _parser_until (app _parser_text _quot_0)) _fm_parser_char_single)) (\_chrs-> (app (app (app _monad_bind _parser_monad) (app _parser_text _quot_0)) (\_-> (let _strx_4 = (app (app (app _list_fold _chrs) _string_nil) _string_cons) in (app (app _monad_pure _parser_monad) (app _fm_term_str _strx_4))))))))))
_fm_parser_suffix = (\_term-> (\_code-> (let _suffix_parser_2 = (app _parser_first_of (app (app _list_cons (app _fm_parser_application _term)) (app (app _list_cons (app _fm_parser_arrow _term)) (app (app _list_cons (app _fm_parser_annotation _term)) _list_nil)))) in (app (app (app _suffix_parser_2 _code) (\_suffix_parsed_code-> (\_suffix_parsed_err-> (app (app _parser_reply_value _code) _term)))) (\_suffix_parsed_code-> (\_suffix_parsed_val-> (app (app _fm_parser_suffix _suffix_parsed_val) _suffix_parsed_code)))))))
_fm_parser_term = (app (app (app _monad_bind _parser_monad) (app _parser_first_of (app (app _list_cons _fm_parser_type) (app (app _list_cons _fm_parser_forall) (app (app _list_cons _fm_parser_lambda) (app (app _list_cons _fm_parser_parenthesis) (app (app _list_cons _fm_parser_letforin) (app (app _list_cons _fm_parser_let) (app (app _list_cons _fm_parser_def) (app (app _list_cons _fm_parser_if) (app (app _list_cons _fm_parser_char) (app (app _list_cons _fm_parser_string) (app (app _list_cons _fm_parser_pair) (app (app _list_cons _fm_parser_list) (app (app _list_cons _fm_parser_forin) (app (app _list_cons _fm_parser_do) (app (app _list_cons _fm_parser_case) (app (app _list_cons _fm_parser_goal) (app (app _list_cons _fm_parser_hole) (app (app _list_cons _fm_parser_nat) (app (app _list_cons _fm_parser_reference) _list_nil))))))))))))))))))))) (\_term-> (app _fm_parser_suffix _term)))
_fm_parser_type = (app (app (app _monad_bind _parser_monad) (app _fm_parser_spaces_text "Type")) (\_-> (app (app _monad_pure _parser_monad) _fm_term_typ)))
_fm_path = ()
_fm_path_nil = (\_x-> _x)
_fm_path_to_bits = (\_path-> (app _path _bits_nil))
_fm_path_0 = (\_path-> (\_x-> (app _path (app _bits_0 _x))))
_fm_path_1 = (\_path-> (\_x-> (app _path (app _bits_1 _x))))
_fm_prim = ()
_fm_prim_bool = (\_bool-> (\_nat-> (\_u16-> (\_string-> _bool))))
_fm_prim_nat = (\_bool-> (\_nat-> (\_u16-> (\_string-> _nat))))
_fm_prim_string = (\_bool-> (\_nat-> (\_u16-> (\_string-> _string))))
_fm_prim_u16 = (\_bool-> (\_nat-> (\_u16-> (\_string-> _u16))))
_fm_term = ()
_fm_term_all = (\_eras-> (\_self-> (\_name-> (\_xtyp-> (\_body-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app (app (app (app _all _eras) _self) _name) _xtyp) _body)))))))))))))))))))))
_fm_term_ann = (\_done-> (\_term-> (\_type-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app (app _ann _done) _term) _type)))))))))))))))))))
_fm_term_app = (\_func-> (\_argm-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app _app _func) _argm))))))))))))))))))
_fm_term_bind = (\_vars-> (\_path-> (\_term-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> (app (app (app (app _list_at_last _term_indx) _vars) (app (app _fm_term_var _term_name) _term_indx)) (\_got_value-> (app _pair_snd _got_value)))))) (\_term_name-> (app (app (app (app _fm_context_find _term_name) _vars) (app _fm_term_ref _term_name)) (\_got_value-> _got_value)))) _fm_term_typ) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (let _vlen_8 = (app _list_length _vars) in (app (app (app (app (app _fm_term_all _term_eras) _term_self) _term_name) (app (app (app _fm_term_bind _vars) (app _fm_path_0 _path)) _term_xtyp)) (\_s-> (\_x-> (app (app (app _fm_term_bind (app (app _list_cons (app (app _pair_new _term_name) _x)) (app (app _list_cons (app (app _pair_new _term_self) _s)) _vars))) (app _fm_path_1 _path)) (app (app _term_body (app (app _fm_term_var _term_self) _vlen_8)) (app (app _fm_term_var _term_name) (app _nat_succ _vlen_8)))))))))))))) (\_term_name-> (\_term_body-> (let _vlen_5 = (app _list_length _vars) in (app (app _fm_term_lam _term_name) (\_x-> (app (app (app _fm_term_bind (app (app _list_cons (app (app _pair_new _term_name) _x)) _vars)) (app _fm_path_0 _path)) (app _term_body (app (app _fm_term_var _term_name) _vlen_5))))))))) (\_term_func-> (\_term_argm-> (app (app _fm_term_app (app (app (app _fm_term_bind _vars) (app _fm_path_0 _path)) _term_func)) (app (app (app _fm_term_bind _vars) (app _fm_path_1 _path)) _term_argm))))) (\_term_name-> (\_term_expr-> (\_term_body-> (let _vlen_6 = (app _list_length _vars) in (app (app (app _fm_term_let _term_name) (app (app (app _fm_term_bind _vars) (app _fm_path_0 _path)) _term_expr)) (\_x-> (app (app (app _fm_term_bind (app (app _list_cons (app (app _pair_new _term_name) _x)) _vars)) (app _fm_path_1 _path)) (app _term_body (app (app _fm_term_var _term_name) _vlen_6)))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (let _vlen_6 = (app _list_length _vars) in (app (app (app _fm_term_def _term_name) (app (app (app _fm_term_bind _vars) (app _fm_path_0 _path)) _term_expr)) (\_x-> (app (app (app _fm_term_bind (app (app _list_cons (app (app _pair_new _term_name) _x)) _vars)) (app _fm_path_1 _path)) (app _term_body (app (app _fm_term_var _term_name) _vlen_6)))))))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app (app _fm_term_ann _term_done) (app (app (app _fm_term_bind _vars) (app _fm_path_0 _path)) _term_term)) (app (app (app _fm_term_bind _vars) (app _fm_path_1 _path)) _term_type)))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (app (app (app _fm_term_gol _term_name) _term_dref) _term_verb))))) (\_term_path-> (app _fm_term_hol (app _fm_path_to_bits _path)))) (\_term_natx-> (app _fm_term_nat _term_natx))) (\_term_chrx-> (app _fm_term_chr _term_chrx))) (\_term_strx-> (app _fm_term_str _term_strx))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> (let _expr_9 = (app (app (app _fm_term_bind _vars) (app _fm_path_0 _path)) _term_expr) in (let _name_10 = _term_name in (let _with_11 = _term_with in (let _cses_12 = _term_cses in (let _moti_13 = _term_moti in (app (app (app (app (app (app _fm_term_cse (app _fm_path_to_bits _path)) _expr_9) _name_10) _with_11) _cses_12) _moti_13))))))))))))))))
_fm_term_check = (\_term-> (\_type-> (\_defs-> (\_ctx-> (\_path-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> (app (app (app (app _list_at_last _term_indx) _ctx) (app (app _fm_check_result _type) (app (app _list_cons (app _fm_error_undefined_reference _term_name)) _list_nil))) (\_got_value-> (app (app _monad_pure _fm_check_monad) (app _got_value (\_got_value_fst-> (\_got_value_snd-> _got_value_snd))))))))) (\_term_name-> (app (app (app (app _fm_get _term_name) _defs) (app (app _fm_check_result _type) (app (app _list_cons (app _fm_error_undefined_reference _term_name)) _list_nil))) (\_got_value-> (app (app _monad_pure _fm_check_monad) (app _got_value (\_got_value_name-> (\_got_value_term-> (\_got_value_type-> (\_got_value_done-> _got_value_type)))))))))) (app (app _monad_pure _fm_check_monad) _fm_term_typ)) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (let _ctx_size_10 = (app _list_length _ctx) in (let _self_var_11 = (app (app _fm_term_var _term_self) _ctx_size_10) in (let _body_var_12 = (app (app _fm_term_var _term_name) (app _nat_succ _ctx_size_10)) in (let _body_ctx_13 = (app (app _list_cons (app (app _pair_new _term_name) _term_xtyp)) (app (app _list_cons (app (app _pair_new _term_self) _term)) _ctx)) in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _term_xtyp) (app _maybe_some _fm_term_typ)) _defs) _ctx) (app _fm_mpath_0 _path))) (\_-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check (app (app _term_body _self_var_11) _body_var_12)) (app _maybe_some _fm_term_typ)) _defs) _body_ctx_13) (app _fm_mpath_1 _path))) (\_-> (app (app _monad_pure _fm_check_monad) _fm_term_typ))))))))))))))) (\_term_name-> (\_term_body-> (app (app _type (app (app _fm_check_result _type) (app (app _list_cons (app (app _fm_error_cant_infer _term) _ctx)) _list_nil))) (\_type_value-> (let _typv_8 = (app (app _fm_term_reduce _type_value) _defs) in (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _typv_8 (\_typv_name-> (\_typv_indx-> (let _expected_11 = (app _either_left "Function") in (let _detected_12 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_11) _detected_12) _ctx)) _list_nil))))))) (\_typv_name-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (let _expected_9 = (app _either_left "Function") in (let _detected_10 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_9) _detected_10) _ctx)) _list_nil))))) (\_typv_eras-> (\_typv_self-> (\_typv_name-> (\_typv_xtyp-> (\_typv_body-> (let _ctx_size_14 = (app _list_length _ctx) in (let _self_var_15 = _term in (let _body_var_16 = (app (app _fm_term_var _term_name) _ctx_size_14) in (let _body_typ_17 = (app (app _typv_body _self_var_15) _body_var_16) in (let _body_ctx_18 = (app (app _list_cons (app (app _pair_new _term_name) _typv_xtyp)) _ctx) in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check (app _term_body _body_var_16)) (app _maybe_some _body_typ_17)) _defs) _body_ctx_18) (app _fm_mpath_0 _path))) (\_-> (app (app _monad_pure _fm_check_monad) _type_value)))))))))))))) (\_typv_name-> (\_typv_body-> (let _expected_11 = (app _either_left "Function") in (let _detected_12 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_11) _detected_12) _ctx)) _list_nil))))))) (\_typv_func-> (\_typv_argm-> (let _expected_11 = (app _either_left "Function") in (let _detected_12 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_11) _detected_12) _ctx)) _list_nil))))))) (\_typv_name-> (\_typv_expr-> (\_typv_body-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_typv_name-> (\_typv_expr-> (\_typv_body-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_typv_done-> (\_typv_term-> (\_typv_type-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_typv_name-> (\_typv_dref-> (\_typv_verb-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_typv_path-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_typv_natx-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_typv_chrx-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_typv_strx-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_typv_path-> (\_typv_expr-> (\_typv_name-> (\_typv_with-> (\_typv_cses-> (\_typv_moti-> (let _expected_15 = (app _either_left "Function") in (let _detected_16 = (app _either_right _type_value) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_15) _detected_16) _ctx)) _list_nil))))))))))))))))) (\_term_func-> (\_term_argm-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _term_func) _maybe_none) _defs) _ctx) (app _fm_mpath_0 _path))) (\_func_typ-> (let _func_typ_8 = (app (app _fm_term_reduce _func_typ) _defs) in (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _func_typ_8 (\_func_typ_name-> (\_func_typ_indx-> (let _expected_11 = (app _either_left "Function") in (let _detected_12 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_11) _detected_12) _ctx)) _list_nil))))))) (\_func_typ_name-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (let _expected_9 = (app _either_left "Function") in (let _detected_10 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_9) _detected_10) _ctx)) _list_nil))))) (\_func_typ_eras-> (\_func_typ_self-> (\_func_typ_name-> (\_func_typ_xtyp-> (\_func_typ_body-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _term_argm) (app _maybe_some _func_typ_xtyp)) _defs) _ctx) (app _fm_mpath_1 _path))) (\_-> (app (app _monad_pure _fm_check_monad) (app (app _func_typ_body _term_func) _term_argm)))))))))) (\_func_typ_name-> (\_func_typ_body-> (let _expected_11 = (app _either_left "Function") in (let _detected_12 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_11) _detected_12) _ctx)) _list_nil))))))) (\_func_typ_func-> (\_func_typ_argm-> (let _expected_11 = (app _either_left "Function") in (let _detected_12 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_11) _detected_12) _ctx)) _list_nil))))))) (\_func_typ_name-> (\_func_typ_expr-> (\_func_typ_body-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_func_typ_name-> (\_func_typ_expr-> (\_func_typ_body-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_func_typ_done-> (\_func_typ_term-> (\_func_typ_type-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_func_typ_name-> (\_func_typ_dref-> (\_func_typ_verb-> (let _expected_12 = (app _either_left "Function") in (let _detected_13 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_12) _detected_13) _ctx)) _list_nil)))))))) (\_func_typ_path-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_func_typ_natx-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_func_typ_chrx-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_func_typ_strx-> (let _expected_10 = (app _either_left "Function") in (let _detected_11 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_10) _detected_11) _ctx)) _list_nil)))))) (\_func_typ_path-> (\_func_typ_expr-> (\_func_typ_name-> (\_func_typ_with-> (\_func_typ_cses-> (\_func_typ_moti-> (let _expected_15 = (app _either_left "Function") in (let _detected_16 = (app _either_right _func_typ_8) in (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch _expected_15) _detected_16) _ctx)) _list_nil))))))))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (let _ctx_size_8 = (app _list_length _ctx) in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _term_expr) _maybe_none) _defs) _ctx) (app _fm_mpath_0 _path))) (\_expr_typ-> (let _body_val_10 = (app _term_body (app (app _fm_term_var _term_name) _ctx_size_8)) in (let _body_ctx_11 = (app (app _list_cons (app (app _pair_new _term_name) _expr_typ)) _ctx) in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _body_val_10) _type) _defs) _body_ctx_11) (app _fm_mpath_1 _path))) (\_body_typ-> (app (app _monad_pure _fm_check_monad) _body_typ)))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app (app (app _fm_term_check (app _term_body _term_expr)) _type) _defs) _ctx) _path))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app (_eli_bool _term_done) (app (app _monad_pure _fm_check_monad) _term_type)) (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _term_term) (app _maybe_some _term_type)) _defs) _ctx) (app _fm_mpath_0 _path))) (\_-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _term_type) (app _maybe_some _fm_term_typ)) _defs) _ctx) (app _fm_mpath_1 _path))) (\_-> (app (app _monad_pure _fm_check_monad) _term_type)))))))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (app (app _fm_check_result _type) (app (app _list_cons (app (app (app (app (app _fm_error_show_goal _term_name) _term_dref) _term_verb) _type) _ctx)) _list_nil)))))) (\_term_path-> (app (app _fm_check_result _type) _list_nil))) (\_term_natx-> (app (app _monad_pure _fm_check_monad) (app _fm_term_ref "Nat")))) (\_term_chrx-> (app (app _monad_pure _fm_check_monad) (app _fm_term_ref "Char")))) (\_term_strx-> (app (app _monad_pure _fm_check_monad) (app _fm_term_ref "String")))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> (let _expr_11 = _term_expr in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _expr_11) _maybe_none) _defs) _ctx) (app _fm_mpath_0 _path))) (\_etyp-> (let _dsug_13 = (app (app (app (app (app (app (app (app _fm_term_desugar_cse _term_expr) _term_name) _term_with) _term_cses) _term_moti) _etyp) _defs) _ctx) in (app (app _dsug_13 (app (app _fm_check_result _type) (app (app _list_cons (app (app _fm_error_cant_infer _term) _ctx)) _list_nil))) (\_dsug_value-> (app (app _fm_check_result _type) (app (app _list_cons (app (app _fm_error_patch (app _fm_mpath_to_bits _path)) _dsug_value)) _list_nil)))))))))))))))) (\_infr-> (app (app _type (app (app _fm_check_result (app _maybe_some _infr)) _list_nil)) (\_type_value-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _type_value) _infr) _defs) (app _list_length _ctx)) _set_new)) (\_eqls-> (app (app (_eli_bool _eqls) (app (app _monad_pure _fm_check_monad) _type_value)) (app (app _fm_check_result _type) (app (app _list_cons (app (app (app _fm_error_type_mismatch (app _either_right _type_value)) (app _either_right _infr)) _ctx)) _list_nil))))))))))))))
_fm_term_chr = (\_chrx-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app _chr _chrx)))))))))))))))))
_fm_term_cse = (\_path-> (\_expr-> (\_name-> (\_with-> (\_cses-> (\_moti-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app (app (app (app (app _cse _path) _expr) _name) _with) _cses) _moti))))))))))))))))))))))
_fm_term_def = (\_name-> (\_expr-> (\_body-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app (app _def _name) _expr) _body)))))))))))))))))))
_fm_term_desugar_app = (\_func-> (\_args-> (\_type-> (\_defs-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _fm_term_reduce _type) _defs) (\_type_name-> (\_type_indx-> _func))) (\_type_name-> _func)) _func) (\_type_eras-> (\_type_self-> (\_type_name-> (\_type_xtyp-> (\_type_body-> (app (app (app (app _fm_get _type_name) _args) _func) (\_got_value-> (let _func_10 = (app (app _fm_term_app _func) _got_value) in (let _type_11 = (app (app _type_body (app (app _fm_term_var _type_self) (0::Integer))) (app (app _fm_term_var _type_name) (0::Integer))) in (app (app (app (app _fm_term_desugar_app _func_10) _args) _type_11) _defs))))))))))) (\_type_name-> (\_type_body-> _func))) (\_type_func-> (\_type_argm-> _func))) (\_type_name-> (\_type_expr-> (\_type_body-> _func)))) (\_type_name-> (\_type_expr-> (\_type_body-> _func)))) (\_type_done-> (\_type_term-> (\_type_type-> _func)))) (\_type_name-> (\_type_dref-> (\_type_verb-> _func)))) (\_type_path-> _func)) (\_type_natx-> _func)) (\_type_chrx-> _func)) (\_type_strx-> _func)) (\_type_path-> (\_type_expr-> (\_type_name-> (\_type_with-> (\_type_cses-> (\_type_moti-> _func)))))))))))
_fm_term_desugar_cse = (\_expr-> (\_name-> (\_with-> (\_cses-> (\_moti-> (\_type-> (\_defs-> (\_ctxt-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _fm_term_reduce _type) _defs) (\_type_name-> (\_type_indx-> _maybe_none))) (\_type_name-> _maybe_none)) _maybe_none) (\_type_eras-> (\_type_self-> (\_type_name-> (\_type_xtyp-> (\_type_body-> (let _moti_13 = (app (app _fm_term_desugar_cse_motive _with) _moti) in (let _argm_14 = (app (app (app (app (app _fm_term_desugar_cse_argument _name) _list_nil) _type_xtyp) _moti_13) _defs) in (let _expr_15 = (app (app _fm_term_app _expr) _argm_14) in (let _type_16 = (app (app _type_body (app (app _fm_term_var _type_self) (0::Integer))) (app (app _fm_term_var _type_name) (0::Integer))) in (app _maybe_some (app (app (app (app (app (app (app _fm_term_desugar_cse_cases _expr_15) _name) _with) _cses) _type_16) _defs) _ctxt)))))))))))) (\_type_name-> (\_type_body-> _maybe_none))) (\_type_func-> (\_type_argm-> _maybe_none))) (\_type_name-> (\_type_expr-> (\_type_body-> _maybe_none)))) (\_type_name-> (\_type_expr-> (\_type_body-> _maybe_none)))) (\_type_done-> (\_type_term-> (\_type_type-> _maybe_none)))) (\_type_name-> (\_type_dref-> (\_type_verb-> _maybe_none)))) (\_type_path-> _maybe_none)) (\_type_natx-> _maybe_none)) (\_type_chrx-> _maybe_none)) (\_type_strx-> _maybe_none)) (\_type_path-> (\_type_expr-> (\_type_name-> (\_type_with-> (\_type_cses-> (\_type_moti-> _maybe_none)))))))))))))))
_fm_term_desugar_cse_argument = (\_name-> (\_wyth-> (\_type-> (\_body-> (\_defs-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _fm_term_reduce _type) _defs) (\_type_name-> (\_type_indx-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs)))))))))))))) (\_type_name-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))) (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs)))))))))))) (\_type_eras-> (\_type_self-> (\_type_name-> (\_type_xtyp-> (\_type_body-> (app (app _fm_term_lam (app _string_flatten (app (app _list_cons _name) (app (app _list_cons (app _fm_name_read ".")) (app (app _list_cons _type_name) _list_nil))))) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth) (app (app _type_body (app (app _fm_term_var _type_self) (0::Integer))) (app (app _fm_term_var _type_name) (0::Integer)))) _body) _defs))))))))) (\_type_name-> (\_type_body-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs)))))))))))))) (\_type_func-> (\_type_argm-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs)))))))))))))) (\_type_name-> (\_type_expr-> (\_type_body-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))))) (\_type_name-> (\_type_expr-> (\_type_body-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))))) (\_type_done-> (\_type_term-> (\_type_type-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))))) (\_type_name-> (\_type_dref-> (\_type_verb-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))))) (\_type_path-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))) (\_type_natx-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))) (\_type_chrx-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))) (\_type_strx-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs))))))))))))) (\_type_path-> (\_type_expr-> (\_type_name-> (\_type_with-> (\_type_cses-> (\_type_moti-> (app (app _wyth _body) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app _fm_term_lam _wyth_head_name) (\_x-> (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth_tail) _type) _body) _defs)))))))))))))))))))))))
_fm_term_desugar_cse_cases = (\_expr-> (\_name-> (\_wyth-> (\_cses-> (\_type-> (\_defs-> (\_ctxt-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _fm_term_reduce _type) _defs) (\_type_name-> (\_type_indx-> (let _expr_9 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_9)))) (\_type_name-> (let _expr_8 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_8))) (let _expr_7 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_7)) (\_type_eras-> (\_type_self-> (\_type_name-> (\_type_xtyp-> (\_type_body-> (let _got_12 = (app (app _maybe_or (app (app _fm_get _type_name) _cses)) (app (app _fm_get "_") _cses)) in (app (app _got_12 (let _expr_13 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> (app (app _fm_term_app _expr) _def_term))))))))) in _expr_13)) (\_got_value-> (let _argm_14 = (app (app (app (app (app _fm_term_desugar_cse_argument _name) _wyth) _type_xtyp) _got_value) _defs) in (let _expr_15 = (app (app _fm_term_app _expr) _argm_14) in (let _type_16 = (app (app _type_body (app (app _fm_term_var _type_self) (0::Integer))) (app (app _fm_term_var _type_name) (0::Integer))) in (app (app (app (app (app (app (app _fm_term_desugar_cse_cases _expr_15) _name) _wyth) _cses) _type_16) _defs) _ctxt))))))))))))) (\_type_name-> (\_type_body-> (let _expr_9 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_9)))) (\_type_func-> (\_type_argm-> (let _expr_9 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_9)))) (\_type_name-> (\_type_expr-> (\_type_body-> (let _expr_10 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_10))))) (\_type_name-> (\_type_expr-> (\_type_body-> (let _expr_10 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_10))))) (\_type_done-> (\_type_term-> (\_type_type-> (let _expr_10 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_10))))) (\_type_name-> (\_type_dref-> (\_type_verb-> (let _expr_10 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_10))))) (\_type_path-> (let _expr_8 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_8))) (\_type_natx-> (let _expr_8 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_8))) (\_type_chrx-> (let _expr_8 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_8))) (\_type_strx-> (let _expr_8 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_8))) (\_type_path-> (\_type_expr-> (\_type_name-> (\_type_with-> (\_type_cses-> (\_type_moti-> (let _expr_13 = (app (app (app _list_for _wyth) _expr) (\_def-> (\_expr-> (app (app _fm_term_app _expr) (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> _def_term))))))))) in _expr_13)))))))))))))))
_fm_term_desugar_cse_motive = (\_wyth-> (\_moti-> (app (app _wyth _moti) (\_wyth_head-> (\_wyth_tail-> (app _wyth_head (\_wyth_head_name-> (\_wyth_head_term-> (\_wyth_head_type-> (\_wyth_head_done-> (app (app (app (app (app _fm_term_all _bool_false) "") _wyth_head_name) _wyth_head_type) (\_s-> (\_x-> (app (app _fm_term_desugar_cse_motive _wyth_tail) _moti))))))))))))))
_fm_term_equal = (\_a-> (\_b-> (\_defs-> (\_lv-> (\_seen-> (let _a1_5 = (app (app _fm_term_reduce _a) _defs) in (let _b1_6 = (app (app _fm_term_reduce _b) _defs) in (let _ak_7 = (app (app (app _fm_term_serialize_go _a1_5) _lv) _lv) in (let _ah_8 = (app _ak_7 _bits_nil) in (let _bh_9 = (app (app (app (app _fm_term_serialize_go _b1_6) _lv) _lv) _bits_nil) in (let _id_10 = (app _ak_7 _bh_9) in (app (app (_eli_bool (app (app _bool_or (app (app _bits_eql _ah_8) _bh_9)) (app (app _set_has _id_10) _seen))) (app (app _monad_pure _fm_check_monad) _bool_true)) (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _a1_5 (\_a1_name-> (\_a1_indx-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false))))))))))) (\_a1_name-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))) (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false))))))))) (\_a1_eras-> (\_a1_self-> (\_a1_name-> (\_a1_xtyp-> (\_a1_body-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (let _seen_21 = (app (app _set_set _id_10) _seen) in (let _a1_body_22 = (app (app _a1_body (app (app _fm_term_var _a1_self) _lv)) (app (app _fm_term_var _a1_name) (app _nat_succ _lv))) in (let _b1_body_23 = (app (app _b1_body (app (app _fm_term_var _b1_self) _lv)) (app (app _fm_term_var _b1_name) (app _nat_succ _lv))) in (let _eq_self_24 = (app (app _string_eql _a1_self) _b1_self) in (app (app (_eli_bool _eq_self_24) (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _a1_xtyp) _b1_xtyp) _defs) _lv) _seen_21)) (\_eq_type-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _a1_body_22) _b1_body_23) _defs) (app _nat_succ (app _nat_succ _lv))) _seen_21)) (\_eq_body-> (app (app _monad_pure _fm_check_monad) (app (app _bool_and _eq_type) _eq_body))))))) (app (app _monad_pure _fm_check_monad) _bool_false)))))))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))))))) (\_a1_name-> (\_a1_body-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (let _seen_15 = (app (app _set_set _id_10) _seen) in (let _a1_body_16 = (app _a1_body (app (app _fm_term_var _a1_name) _lv)) in (let _b1_body_17 = (app _b1_body (app (app _fm_term_var _b1_name) _lv)) in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _a1_body_16) _b1_body_17) _defs) (app _nat_succ _lv)) _seen_15)) (\_eq_body-> (app (app _monad_pure _fm_check_monad) _eq_body))))))))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false))))))))))) (\_a1_func-> (\_a1_argm-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (let _seen_15 = (app (app _set_set _id_10) _seen) in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _a1_func) _b1_func) _defs) _lv) _seen_15)) (\_eq_func-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _a1_argm) _b1_argm) _defs) _lv) _seen_15)) (\_eq_argm-> (app (app _monad_pure _fm_check_monad) (app (app _bool_and _eq_func) _eq_argm)))))))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false))))))))))) (\_a1_name-> (\_a1_expr-> (\_a1_body-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (let _seen_17 = (app (app _set_set _id_10) _seen) in (let _a1_body_18 = (app _a1_body (app (app _fm_term_var _a1_name) _lv)) in (let _b1_body_19 = (app _b1_body (app (app _fm_term_var _b1_name) _lv)) in (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _a1_expr) _b1_expr) _defs) _lv) _seen_17)) (\_eq_expr-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_equal _a1_body_18) _b1_body_19) _defs) (app _nat_succ _lv)) _seen_17)) (\_eq_body-> (app (app _monad_pure _fm_check_monad) (app (app _bool_and _eq_expr) _eq_body))))))))))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))))) (\_a1_name-> (\_a1_expr-> (\_a1_body-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))))) (\_a1_done-> (\_a1_term-> (\_a1_type-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))))) (\_a1_name-> (\_a1_dref-> (\_a1_verb-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))))) (\_a1_path-> (app (app _fm_term_equal_patch _a1_path) _b))) (\_a1_natx-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))) (\_a1_chrx-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))) (\_a1_strx-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))) (\_a1_path-> (\_a1_expr-> (\_a1_name-> (\_a1_with-> (\_a1_cses-> (\_a1_moti-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _b1_6 (\_b1_name-> (\_b1_indx-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (app (app _monad_pure _fm_check_monad) _bool_false))) (app (app _monad_pure _fm_check_monad) _bool_false)) (\_b1_eras-> (\_b1_self-> (\_b1_name-> (\_b1_xtyp-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))))) (\_b1_name-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_func-> (\_b1_argm-> (app (app _monad_pure _fm_check_monad) _bool_false)))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_expr-> (\_b1_body-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_done-> (\_b1_term-> (\_b1_type-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_name-> (\_b1_dref-> (\_b1_verb-> (app (app _monad_pure _fm_check_monad) _bool_false))))) (\_b1_path-> (app (app _fm_term_equal_patch _b1_path) _a))) (\_b1_natx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_chrx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_strx-> (app (app _monad_pure _fm_check_monad) _bool_false))) (\_b1_path-> (\_b1_expr-> (\_b1_name-> (\_b1_with-> (\_b1_cses-> (\_b1_moti-> (app (app _monad_pure _fm_check_monad) _bool_false)))))))))))))))))))))))))))
_fm_term_equal_patch = (\_path-> (\_term-> (app (app _fm_check_result (app _maybe_some _bool_true)) (app (app _list_cons (app (app _fm_error_patch _path) (app (app _fm_term_normalize _term) _map_new))) _list_nil))))
_fm_term_expand = (\_dref-> (\_term-> (\_defs-> (let _term_3 = (app (app _fm_term_normalize _term) _map_new) in (let _term_4 = (app (app (app _list_for _dref) _term_3) (\_path-> (\_term-> (app (app _fm_term_normalize (app (app (app _fm_term_expand_at _path) _term) _defs)) _map_new)))) in _term_4)))))
_fm_term_expand_at = (\_path-> (\_term-> (\_defs-> (app (app (app _fm_term_patch_at _path) _term) (\_term-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> _term))) (\_term_name-> (app (app (app (app _fm_get _term_name) _defs) (app _fm_term_ref _term_name)) (\_got_value-> (app _got_value (\_got_value_name-> (\_got_value_term-> (\_got_value_type-> (\_got_value_done-> _got_value_term))))))))) _term) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> _term)))))) (\_term_name-> (\_term_body-> _term))) (\_term_func-> (\_term_argm-> _term))) (\_term_name-> (\_term_expr-> (\_term_body-> _term)))) (\_term_name-> (\_term_expr-> (\_term_body-> _term)))) (\_term_done-> (\_term_term-> (\_term_type-> _term)))) (\_term_name-> (\_term_dref-> (\_term_verb-> _term)))) (\_term_path-> _term)) (\_term_natx-> _term)) (\_term_chrx-> _term)) (\_term_strx-> _term)) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> _term))))))))))))
_fm_term_gol = (\_name-> (\_dref-> (\_verb-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app (app _gol _name) _dref) _verb)))))))))))))))))))
_fm_term_hol = (\_path-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app _hol _path)))))))))))))))))
_fm_term_lam = (\_name-> (\_body-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app _lam _name) _body))))))))))))))))))
_fm_term_let = (\_name-> (\_expr-> (\_body-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app (app _let _name) _expr) _body)))))))))))))))))))
_fm_term_nat = (\_natx-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app _nat _natx)))))))))))))))))
_fm_term_normalize = (\_term-> (\_defs-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _fm_term_reduce _term) _defs) (\_term_name-> (\_term_indx-> (app (app _fm_term_var _term_name) _term_indx)))) (\_term_name-> (app _fm_term_ref _term_name))) _fm_term_typ) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (app (app (app (app (app _fm_term_all _term_eras) _term_self) _term_name) (app (app _fm_term_normalize _term_xtyp) _defs)) (\_s-> (\_x-> (app (app _fm_term_normalize (app (app _term_body _s) _x)) _defs)))))))))) (\_term_name-> (\_term_body-> (app (app _fm_term_lam _term_name) (\_x-> (app (app _fm_term_normalize (app _term_body _x)) _defs)))))) (\_term_func-> (\_term_argm-> (app (app _fm_term_app (app (app _fm_term_normalize _term_func) _defs)) (app (app _fm_term_normalize _term_argm) _defs))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app _fm_term_let _term_name) (app (app _fm_term_normalize _term_expr) _defs)) (\_x-> (app (app _fm_term_normalize (app _term_body _x)) _defs))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app _fm_term_def _term_name) (app (app _fm_term_normalize _term_expr) _defs)) (\_x-> (app (app _fm_term_normalize (app _term_body _x)) _defs))))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app (app _fm_term_ann _term_done) (app (app _fm_term_normalize _term_term) _defs)) (app (app _fm_term_normalize _term_type) _defs)))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (app (app (app _fm_term_gol _term_name) _term_dref) _term_verb))))) (\_term_path-> (app _fm_term_hol _term_path))) (\_term_natx-> (app _fm_term_nat _term_natx))) (\_term_chrx-> (app _fm_term_chr _term_chrx))) (\_term_strx-> (app _fm_term_str _term_strx))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> _term)))))))))
_fm_term_patch_at = (\_path-> (\_term-> (\_fn-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term))))) (\_term_name-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term)))) (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term))) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (app (app (app _path (app _fn _term)) (\_path_pred-> (app (app (app (app (app _fm_term_all _term_eras) _term_self) _term_name) (app (app (app _fm_term_patch_at _path_pred) _term_xtyp) _fn)) _term_body))) (\_path_pred-> (app (app (app (app (app _fm_term_all _term_eras) _term_self) _term_name) _term_xtyp) (\_s-> (\_x-> (app (app (app _fm_term_patch_at _path_pred) (app (app _term_body _s) _x)) _fn)))))))))))) (\_term_name-> (\_term_body-> (app (app (app _path (app _fn _term)) (\_path_pred-> (app (app _fm_term_lam _term_name) (\_x-> (app (app (app _fm_term_patch_at (app _bits_tail _path)) (app _term_body _x)) _fn))))) (\_path_pred-> (app (app _fm_term_lam _term_name) (\_x-> (app (app (app _fm_term_patch_at (app _bits_tail _path)) (app _term_body _x)) _fn)))))))) (\_term_func-> (\_term_argm-> (app (app (app _path (app _fn _term)) (\_path_pred-> (app (app _fm_term_app (app (app (app _fm_term_patch_at _path_pred) _term_func) _fn)) _term_argm))) (\_path_pred-> (app (app _fm_term_app _term_func) (app (app (app _fm_term_patch_at _path_pred) _term_argm) _fn))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app _path (app _fn _term)) (\_path_pred-> (app (app (app _fm_term_let _term_name) (app (app (app _fm_term_patch_at _path_pred) _term_expr) _fn)) _term_body))) (\_path_pred-> (app (app (app _fm_term_let _term_name) _term_expr) (\_x-> (app (app (app _fm_term_patch_at _path_pred) (app _term_body _x)) _fn))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app _path (app _fn _term)) (\_path_pred-> (app (app (app _fm_term_def _term_name) (app (app (app _fm_term_patch_at _path_pred) _term_expr) _fn)) _term_body))) (\_path_pred-> (app (app (app _fm_term_def _term_name) _term_expr) (\_x-> (app (app (app _fm_term_patch_at _path_pred) (app _term_body _x)) _fn))))))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app (app _path (app _fn _term)) (\_path_pred-> (app (app (app _fm_term_ann _term_done) (app (app (app _fm_term_patch_at _path) _term_term) _fn)) _term_type))) (\_path_pred-> (app (app (app _fm_term_ann _term_done) (app (app (app _fm_term_patch_at _path) _term_term) _fn)) _term_type))))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term)))))) (\_term_path-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term)))) (\_term_natx-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term)))) (\_term_chrx-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term)))) (\_term_strx-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term)))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> (app (app (app _path (app _fn _term)) (\_path_pred-> _term)) (\_path_pred-> _term))))))))))))
_fm_term_read = (\_code-> (app (app (app _fm_parser_term _code) (\_parsed_code-> (\_parsed_err-> _maybe_none))) (\_parsed_code-> (\_parsed_val-> (app _maybe_some _parsed_val)))))
_fm_term_reduce = (\_term-> (\_defs-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> _term))) (\_term_name-> (app (app (app (app _fm_get _term_name) _defs) (app _fm_term_ref _term_name)) (\_got_value-> (app _got_value (\_got_value_name-> (\_got_value_term-> (\_got_value_type-> (\_got_value_done-> (app (app _fm_term_reduce _got_value_term) _defs)))))))))) _term) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> _term)))))) (\_term_name-> (\_term_body-> _term))) (\_term_func-> (\_term_argm-> (let _func_4 = (app (app _fm_term_reduce _term_func) _defs) in (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _func_4 (\_func_name-> (\_func_indx-> _term))) (\_func_name-> _term)) _term) (\_func_eras-> (\_func_self-> (\_func_name-> (\_func_xtyp-> (\_func_body-> _term)))))) (\_func_name-> (\_func_body-> (app (app _fm_term_reduce (app _func_body _term_argm)) _defs)))) (\_func_func-> (\_func_argm-> _term))) (\_func_name-> (\_func_expr-> (\_func_body-> _term)))) (\_func_name-> (\_func_expr-> (\_func_body-> _term)))) (\_func_done-> (\_func_term-> (\_func_type-> _term)))) (\_func_name-> (\_func_dref-> (\_func_verb-> _term)))) (\_func_path-> _term)) (\_func_natx-> _term)) (\_func_chrx-> _term)) (\_func_strx-> _term)) (\_func_path-> (\_func_expr-> (\_func_name-> (\_func_with-> (\_func_cses-> (\_func_moti-> _term))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app _fm_term_reduce (app _term_body _term_expr)) _defs))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app _fm_term_reduce (app _term_body _term_expr)) _defs))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app _fm_term_reduce _term_term) _defs))))) (\_term_name-> (\_term_dref-> (\_term_verb-> _term)))) (\_term_path-> _term)) (\_term_natx-> (app (app _fm_term_reduce (app _fm_term_unroll_nat _term_natx)) _defs))) (\_term_chrx-> (app (app _fm_term_reduce (app _fm_term_unroll_chr _term_chrx)) _defs))) (\_term_strx-> (app (app _fm_term_reduce (app _fm_term_unroll_str _term_strx)) _defs))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> _term)))))))))
_fm_term_ref = (\_name-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app _ref _name)))))))))))))))))
_fm_term_serialize = (\_term-> (\_depth-> (app (app (app (app _fm_term_serialize_go _term) _depth) _depth) _bits_nil)))
_fm_term_serialize_go = (\_term-> (\_depth-> (\_init-> (\_x-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> (app (app (_eli_bool (app (app _nat_gte _term_indx) _init)) (let _name_6 = (app _bits_concat (app _nat_to_bits (app _nat_pred (app (app _nat_sub _depth) _term_indx)))) in (app _bits_0 (app _bits_0 (app _bits_1 (app _name_6 _x)))))) (let _name_6 = (app _bits_concat (app _nat_to_bits _term_indx)) in (app _bits_0 (app _bits_1 (app _bits_0 (app _name_6 _x))))))))) (\_term_name-> (let _name_5 = (app _bits_concat (app _fm_name_to_bits _term_name)) in (app _bits_0 (app _bits_0 (app _bits_0 (app _name_5 _x))))))) (app _bits_0 (app _bits_1 (app _bits_1 _x)))) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (let _self_9 = (app _bits_concat (app _fm_name_to_bits _term_self)) in (let _xtyp_10 = (app (app (app _fm_term_serialize_go _term_xtyp) _depth) _init) in (let _body_11 = (app (app (app _fm_term_serialize_go (app (app _term_body (app (app _fm_term_var _term_self) _depth)) (app (app _fm_term_var _term_name) (app _nat_succ _depth)))) (app _nat_succ (app _nat_succ _depth))) _init) in (app _bits_1 (app _bits_0 (app _bits_0 (app _self_9 (app _xtyp_10 (app _body_11 _x))))))))))))))) (\_term_name-> (\_term_body-> (let _body_6 = (app (app (app _fm_term_serialize_go (app _term_body (app (app _fm_term_var _term_name) _depth))) (app _nat_succ _depth)) _init) in (app _bits_1 (app _bits_0 (app _bits_1 (app _body_6 _x)))))))) (\_term_func-> (\_term_argm-> (let _func_6 = (app (app (app _fm_term_serialize_go _term_func) _depth) _init) in (let _argm_7 = (app (app (app _fm_term_serialize_go _term_argm) _depth) _init) in (app _bits_1 (app _bits_1 (app _bits_0 (app _func_6 (app _argm_7 _x)))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (let _expr_7 = (app (app (app _fm_term_serialize_go _term_expr) _depth) _init) in (let _body_8 = (app (app (app _fm_term_serialize_go (app _term_body (app (app _fm_term_var _term_name) _depth))) (app _nat_succ _depth)) _init) in (app _bits_1 (app _bits_1 (app _bits_1 (app _expr_7 (app _body_8 _x))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app (app _fm_term_serialize_go (app _term_body _term_expr)) _depth) _init) _x))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app (app (app _fm_term_serialize_go _term_term) _depth) _init) _x))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (let _name_7 = (app _bits_concat (app _fm_name_to_bits _term_name)) in (app _bits_0 (app _bits_0 (app _bits_0 (app _name_7 _x))))))))) (\_term_path-> _x)) (\_term_natx-> (app _bits_0 (app _bits_0 (app _bits_0 (app (app _bits_concat (app _nat_to_bits _term_natx)) _x)))))) (\_term_chrx-> (app _bits_0 (app _bits_0 (app _bits_0 (app (app _bits_concat (app _word_to_bits (app _u16_to_word _term_chrx))) _x)))))) (\_term_strx-> (app (app (app (app _fm_term_serialize_go (app _fm_term_unroll_str _term_strx)) _depth) _init) _x))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> _x)))))))))))
_fm_term_serialize_string = (\_term-> (\_depth-> (\_init-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> (app (app (_eli_bool (app (app _nat_gte _term_indx) _init)) (app (app _string_concat "#") (app _nat_show (app _nat_pred (app (app _nat_sub _depth) _term_indx))))) (app (app _string_concat "^") (app _nat_show _term_indx)))))) (\_term_name-> _term_name)) "*") (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (app _string_flatten (app (app _list_cons "∀") (app (app _list_cons _term_self) (app (app _list_cons (app (app (app _fm_term_serialize_string _term_xtyp) _depth) _init)) (app (app _list_cons (app (app (app _fm_term_serialize_string (app (app _term_body (app (app _fm_term_var _term_self) _depth)) (app (app _fm_term_var _term_name) (app _nat_succ _depth)))) (app _nat_succ (app _nat_succ _depth))) _init)) _list_nil))))))))))) (\_term_name-> (\_term_body-> (app _string_flatten (app (app _list_cons "λ") (app (app _list_cons (app (app (app _fm_term_serialize_string (app _term_body (app (app _fm_term_var _term_name) _depth))) (app _nat_succ _depth)) _init)) _list_nil)))))) (\_term_func-> (\_term_argm-> (app _string_flatten (app (app _list_cons "@") (app (app _list_cons (app (app (app _fm_term_serialize_string _term_func) _depth) _init)) (app (app _list_cons (app (app (app _fm_term_serialize_string _term_argm) _depth) _init)) _list_nil))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app _string_flatten (app (app _list_cons "$") (app (app _list_cons (app (app (app _fm_term_serialize_string _term_expr) _depth) _init)) (app (app _list_cons (app (app (app _fm_term_serialize_string (app _term_body (app (app _fm_term_var _term_name) _depth))) (app _nat_succ _depth)) _init)) _list_nil)))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (app (app (app _fm_term_serialize_string (app _term_body _term_expr)) _depth) _init))))) (\_term_done-> (\_term_term-> (\_term_type-> (app (app (app _fm_term_serialize_string _term_term) _depth) _init))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (app _string_flatten (app (app _list_cons "?") (app (app _list_cons _term_name) _list_nil))))))) (\_term_path-> "_")) (\_term_natx-> "_")) (\_term_chrx-> "_")) (\_term_strx-> "_")) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> "_"))))))))))
_fm_term_show = (\_term-> (app (app _fm_term_show_go _term) _maybe_none))
_fm_term_show_as_nat = (\_term-> (app (app _maybe_mapped (app _fm_term_show_as_nat_go _term)) _nat_show))
_fm_term_show_as_nat_go = (\_term-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> _maybe_none))) (\_term_name-> (app (app (_eli_bool (app (app _string_eql _term_name) "Nat.zero")) (app _maybe_some (0::Integer))) _maybe_none))) _maybe_none) (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> _maybe_none)))))) (\_term_name-> (\_term_body-> _maybe_none))) (\_term_func-> (\_term_argm-> (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term_func (\_term_func_name-> (\_term_func_indx-> _maybe_none))) (\_term_func_name-> (app (app (_eli_bool (app (app _string_eql _term_func_name) "Nat.succ")) (app (app (app _monad_bind _maybe_monad) (app _fm_term_show_as_nat_go _term_argm)) (\_pred-> (app (app _monad_pure _maybe_monad) (app _nat_succ _pred))))) _maybe_none))) _maybe_none) (\_term_func_eras-> (\_term_func_self-> (\_term_func_name-> (\_term_func_xtyp-> (\_term_func_body-> _maybe_none)))))) (\_term_func_name-> (\_term_func_body-> _maybe_none))) (\_term_func_func-> (\_term_func_argm-> _maybe_none))) (\_term_func_name-> (\_term_func_expr-> (\_term_func_body-> _maybe_none)))) (\_term_func_name-> (\_term_func_expr-> (\_term_func_body-> _maybe_none)))) (\_term_func_done-> (\_term_func_term-> (\_term_func_type-> _maybe_none)))) (\_term_func_name-> (\_term_func_dref-> (\_term_func_verb-> _maybe_none)))) (\_term_func_path-> _maybe_none)) (\_term_func_natx-> _maybe_none)) (\_term_func_chrx-> _maybe_none)) (\_term_func_strx-> _maybe_none)) (\_term_func_path-> (\_term_func_expr-> (\_term_func_name-> (\_term_func_with-> (\_term_func_cses-> (\_term_func_moti-> _maybe_none)))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> _maybe_none)))) (\_term_name-> (\_term_expr-> (\_term_body-> _maybe_none)))) (\_term_done-> (\_term_term-> (\_term_type-> _maybe_none)))) (\_term_name-> (\_term_dref-> (\_term_verb-> _maybe_none)))) (\_term_path-> _maybe_none)) (\_term_natx-> _maybe_none)) (\_term_chrx-> _maybe_none)) (\_term_strx-> _maybe_none)) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> _maybe_none))))))))
_fm_term_show_go = (\_term-> (\_path-> (app (app (app _fm_term_show_as_nat _term) (app (app (app (app (app (app (app (app (app (app (app (app (app (app (app _term (\_term_name-> (\_term_indx-> (app _fm_name_show _term_name)))) (\_term_name-> (let _name_3 = (app _fm_name_show _term_name) in (app (app _path _name_3) (\_path_value-> (let _path_val_5 = (app (app _bits_concat (app _fm_path_to_bits _path_value)) (app _bits_1 _bits_nil)) in (let _path_str_6 = (app _nat_show (app _bits_to_nat _path_val_5)) in (app _string_flatten (app (app _list_cons _name_3) (app (app _list_cons "\x1b[2m-") (app (app _list_cons _path_str_6) (app (app _list_cons "\x1b[0m") _list_nil)))))))))))) "Type") (\_term_eras-> (\_term_self-> (\_term_name-> (\_term_xtyp-> (\_term_body-> (let _eras_7 = _term_eras in (let _self_8 = (app _fm_name_show _term_self) in (let _name_9 = (app _fm_name_show _term_name) in (let _type_10 = (app (app _fm_term_show_go _term_xtyp) (app _fm_mpath_0 _path)) in (let _open_11 = (app (app (_eli_bool _eras_7) "<") "(") in (let _clos_12 = (app (app (_eli_bool _eras_7) ">") ")") in (let _body_13 = (app (app _fm_term_show_go (app (app _term_body (app (app _fm_term_var _term_self) (0::Integer))) (app (app _fm_term_var _term_name) (0::Integer)))) (app _fm_mpath_1 _path)) in (app _string_flatten (app (app _list_cons _self_8) (app (app _list_cons _open_11) (app (app _list_cons _name_9) (app (app _list_cons ":") (app (app _list_cons _type_10) (app (app _list_cons _clos_12) (app (app _list_cons " ") (app (app _list_cons _body_13) _list_nil)))))))))))))))))))))) (\_term_name-> (\_term_body-> (let _name_4 = (app _fm_name_show _term_name) in (let _body_5 = (app (app _fm_term_show_go (app _term_body (app (app _fm_term_var _term_name) (0::Integer)))) (app _fm_mpath_0 _path)) in (app _string_flatten (app (app _list_cons "(") (app (app _list_cons _name_4) (app (app _list_cons ") ") (app (app _list_cons _body_5) _list_nil)))))))))) (\_term_func-> (\_term_argm-> (let _func_4 = (app (app _fm_term_show_go _term_func) (app _fm_mpath_0 _path)) in (let _argm_5 = (app (app _fm_term_show_go _term_argm) (app _fm_mpath_1 _path)) in (let _wrap_6 = (app (app (_eli_string _func_4) _bool_false) (\_func_head-> (\_func_tail-> (app (app _u16_eql _func_head) (40::Word16))))) in (app (app (_eli_bool _wrap_6) (app _string_flatten (app (app _list_cons "(") (app (app _list_cons _func_4) (app (app _list_cons ")") (app (app _list_cons "(") (app (app _list_cons _argm_5) (app (app _list_cons ")") _list_nil)))))))) (app _string_flatten (app (app _list_cons _func_4) (app (app _list_cons "(") (app (app _list_cons _argm_5) (app (app _list_cons ")") _list_nil)))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (let _name_5 = (app _fm_name_show _term_name) in (let _expr_6 = (app (app _fm_term_show_go _term_expr) (app _fm_mpath_0 _path)) in (let _body_7 = (app (app _fm_term_show_go (app _term_body (app (app _fm_term_var _term_name) (0::Integer)))) (app _fm_mpath_1 _path)) in (app _string_flatten (app (app _list_cons "let ") (app (app _list_cons _name_5) (app (app _list_cons " = ") (app (app _list_cons _expr_6) (app (app _list_cons "; ") (app (app _list_cons _body_7) _list_nil)))))))))))))) (\_term_name-> (\_term_expr-> (\_term_body-> (let _name_5 = (app _fm_name_show _term_name) in (let _expr_6 = (app (app _fm_term_show_go _term_expr) (app _fm_mpath_0 _path)) in (let _body_7 = (app (app _fm_term_show_go (app _term_body (app (app _fm_term_var _term_name) (0::Integer)))) (app _fm_mpath_1 _path)) in (app _string_flatten (app (app _list_cons "def ") (app (app _list_cons _name_5) (app (app _list_cons " = ") (app (app _list_cons _expr_6) (app (app _list_cons "; ") (app (app _list_cons _body_7) _list_nil)))))))))))))) (\_term_done-> (\_term_term-> (\_term_type-> (let _term_5 = (app (app _fm_term_show_go _term_term) (app _fm_mpath_0 _path)) in (let _type_6 = (app (app _fm_term_show_go _term_type) (app _fm_mpath_1 _path)) in (app _string_flatten (app (app _list_cons _term_5) (app (app _list_cons "::") (app (app _list_cons _type_6) _list_nil)))))))))) (\_term_name-> (\_term_dref-> (\_term_verb-> (let _name_5 = (app _fm_name_show _term_name) in (app _string_flatten (app (app _list_cons "?") (app (app _list_cons _name_5) _list_nil)))))))) (\_term_path-> "_")) (\_term_natx-> (app _string_flatten (app (app _list_cons (app _nat_show _term_natx)) _list_nil)))) (\_term_chrx-> (app (app _string_cons _term_chrx) _string_nil))) (\_term_strx-> (app _string_flatten (app (app _list_cons "\"") (app (app _list_cons (app _fm_escape _term_strx)) (app (app _list_cons "\"") _list_nil)))))) (\_term_path-> (\_term_expr-> (\_term_name-> (\_term_with-> (\_term_cses-> (\_term_moti-> (let _expr_8 = (app (app _fm_term_show_go _term_expr) (app _fm_mpath_0 _path)) in (let _name_9 = (app _fm_name_show _term_name) in (let _with_10 = (app (app _string_join "") (app (app _list_mapped _term_with) (\_def-> (app _def (\_def_name-> (\_def_term-> (\_def_type-> (\_def_done-> (let _name_15 = (app _fm_name_show _def_name) in (let _type_16 = (app (app _fm_term_show_go _def_type) _maybe_none) in (let _term_17 = (app (app _fm_term_show_go _def_term) _maybe_none) in (app _string_flatten (app (app _list_cons _name_15) (app (app _list_cons ": ") (app (app _list_cons _type_16) (app (app _list_cons " = ") (app (app _list_cons _term_17) (app (app _list_cons ";") _list_nil)))))))))))))))))) in (let _cses_11 = (app _map_to_list _term_cses) in (let _cses_12 = (app (app _string_join "") (app (app _list_mapped _cses_11) (\_x-> (let _name_13 = (app _fm_name_from_bits (app _pair_fst _x)) in (let _term_14 = (app (app _fm_term_show_go (app _pair_snd _x)) _maybe_none) in (app _string_flatten (app (app _list_cons _name_13) (app (app _list_cons ": ") (app (app _list_cons _term_14) (app (app _list_cons "; ") _list_nil)))))))))) in (let _moti_13 = (app (app _fm_term_show_go _term_moti) _maybe_none) in (app _string_flatten (app (app _list_cons "case ") (app (app _list_cons _expr_8) (app (app _list_cons " as ") (app (app _list_cons _name_9) (app (app _list_cons _with_10) (app (app _list_cons " { ") (app (app _list_cons _cses_12) (app (app _list_cons "} : ") (app (app _list_cons _moti_13) _list_nil)))))))))))))))))))))))) (\_as_nat_value-> _as_nat_value))))
_fm_term_str = (\_strx-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app _str _strx)))))))))))))))))
_fm_term_typ = (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> _typ)))))))))))))))
_fm_term_unroll_chr = (\_chrx-> (app (_eli_u16 _chrx) (\_chrx_value-> (let _term_2 = (app _fm_term_ref (app _fm_name_read "Word.from_bits")) in (let _term_3 = (app (app _fm_term_app _term_2) (app _fm_term_nat (16::Integer))) in (let _term_4 = (app (app _fm_term_app _term_3) (app _fm_term_unroll_chr_bits (app _word_to_bits _chrx_value))) in (let _term_5 = (app (app _fm_term_app (app _fm_term_ref (app _fm_name_read "U16.new"))) _term_4) in _term_5)))))))
_fm_term_unroll_chr_bits = (\_bits-> (app (app (app _bits (app _fm_term_ref (app _fm_name_read "Bits.nil"))) (\_bits_pred-> (app (app _fm_term_app (app _fm_term_ref (app _fm_name_read "Bits.0"))) (app _fm_term_unroll_chr_bits _bits_pred)))) (\_bits_pred-> (app (app _fm_term_app (app _fm_term_ref (app _fm_name_read "Bits.1"))) (app _fm_term_unroll_chr_bits _bits_pred)))))
_fm_term_unroll_nat = (\_natx-> (app (app (_eli_nat _natx) (app _fm_term_ref (app _fm_name_read "Nat.zero"))) (\_natx_pred-> (let _func_2 = (app _fm_term_ref (app _fm_name_read "Nat.succ")) in (let _argm_3 = (app _fm_term_nat _natx_pred) in (app (app _fm_term_app _func_2) _argm_3))))))
_fm_term_unroll_str = (\_strx-> (app (app (_eli_string _strx) (app _fm_term_ref (app _fm_name_read "String.nil"))) (\_strx_head-> (\_strx_tail-> (let _char_3 = (app _fm_term_chr _strx_head) in (let _term_4 = (app _fm_term_ref (app _fm_name_read "String.cons")) in (let _term_5 = (app (app _fm_term_app _term_4) _char_3) in (let _term_6 = (app (app _fm_term_app _term_5) (app _fm_term_str _strx_tail)) in _term_6))))))))
_fm_term_var = (\_name-> (\_indx-> (\_var-> (\_ref-> (\_typ-> (\_all-> (\_lam-> (\_app-> (\_let-> (\_def-> (\_ann-> (\_gol-> (\_hol-> (\_nat-> (\_chr-> (\_str-> (\_cse-> (app (app _var _name) _indx))))))))))))))))))
_fm_escape = (\_str-> (app (app (_eli_string _str) "") (\_str_head-> (\_str_tail-> (let _head_3 = _str_head in (let _tail_4 = (app _fm_escape _str_tail) in (app (app (app _list_fold _fm_escapes) (app (app _string_cons _head_3) _tail_4)) (\_esc-> (\_cont-> (app _esc (\_esc_fst-> (\_esc_snd-> (app (app (_eli_bool (app (app _u16_eql _head_3) _esc_snd)) (app (app _string_concat _esc_fst) _tail_4)) _cont)))))))))))))
_fm_escapes = (app (app _list_cons (app (app _pair_new "\\b") (8::Word16))) (app (app _list_cons (app (app _pair_new "\\f") (12::Word16))) (app (app _list_cons (app (app _pair_new "\\n") (10::Word16))) (app (app _list_cons (app (app _pair_new "\\r") (13::Word16))) (app (app _list_cons (app (app _pair_new "\\t") (9::Word16))) (app (app _list_cons (app (app _pair_new "\\v") (11::Word16))) (app (app _list_cons (app (app _pair_new "\\\"") (34::Word16))) (app (app _list_cons (app (app _pair_new "\\0") (0::Word16))) (app (app _list_cons (app (app _pair_new "\\'") (39::Word16))) _list_nil)))))))))
_fm_get = (\_name-> (\_map-> (app (app _map_get (app _fm_name_to_bits _name)) _map)))
_fm_report = (\_defs-> (let _state_1 = (app (app _pair_new "") "") in (let _state_2 = (app (app (app _list_for (app _map_to_list _defs)) _state_1) (\_def-> (\_state-> (app _state (\_state_fst-> (\_state_snd-> (app _def (\_def_fst-> (\_def_snd-> (app _def_snd (\_def_snd_name-> (\_def_snd_term-> (\_def_snd_type-> (\_def_snd_done-> (let _name_12 = (app _fm_name_from_bits _def_fst) in (let _term_13 = _def_snd_term in (let _type_14 = _def_snd_type in (let _check_15 = (app (app (app (app (app _fm_term_check _term_13) (app _maybe_some _type_14)) _defs) _list_nil) _fm_mpath_nil) in (app _check_15 (\_check_value-> (\_check_errors-> (app (app _check_errors (let _name_str_18 = (app _fm_name_show _name_12) in (let _type_str_19 = (app _fm_term_show _type_14) in (let _term_str_20 = (app _fm_term_show _term_13) in (let _string_0_21 = (app _string_flatten (app (app _list_cons _state_fst) (app (app _list_cons _name_str_18) (app (app _list_cons ": ") (app (app _list_cons _type_str_19) (app (app _list_cons "\n  ") (app (app _list_cons _term_str_20) (app (app _list_cons "\n\n") _list_nil)))))))) in (let _string_1_22 = _state_snd in (app (app _pair_new _string_0_21) _string_1_22))))))) (\_check_errors_head-> (\_check_errors_tail-> (let _name_str_20 = (app _fm_name_show _name_12) in (let _type_str_21 = "<error>" in (let _string_0_22 = (app _string_flatten (app (app _list_cons _state_fst) (app (app _list_cons _name_str_20) (app (app _list_cons ": ") (app (app _list_cons _type_str_21) (app (app _list_cons "\n\n") _list_nil)))))) in (let _string_1_23 = _state_snd in (let _string_1_24 = (app (app (app _list_for _check_errors) _string_1_23) (\_error-> (\_string_1-> (app _string_flatten (app (app _list_cons _string_1) (app (app _list_cons "On ") (app (app _list_cons _name_str_20) (app (app _list_cons ":\n") (app (app _list_cons (app (app _fm_error_show _error) _defs)) (app (app _list_cons "\n") _list_nil)))))))))) in (app (app _pair_new _string_0_22) _string_1_24)))))))))))))))))))))))))))))) in (app _state_2 (\_state_fst-> (\_state_snd-> (app _string_flatten (app (app _list_cons "\n# Types:\n\n") (app (app _list_cons _state_fst) (app (app _list_cons "\n") (app (app _list_cons (app (app (_eli_string _state_snd) "") (\_state_snd_head-> (\_state_snd_tail-> (app _string_flatten (app (app _list_cons "# Errors:\n\n") (app (app _list_cons _state_snd) _list_nil))))))) _list_nil)))))))))))
_fm_set = (\_name-> (\_val-> (\_map-> (app (app (app _map_set (app _fm_name_to_bits _name)) _val) _map))))
_fm_synth = (\_defs-> (let _defs_1 = (app (app (app _list_for (app _map_to_list _defs)) _defs) (\_def-> (\_defs-> (app _def (\_def_fst-> (\_def_snd-> (app _def_snd (\_def_snd_name-> (\_def_snd_term-> (\_def_snd_type-> (\_def_snd_done-> (let _name_9 = (app _fm_name_from_bits _def_fst) in (let _term_10 = _def_snd_term in (let _type_11 = _def_snd_type in (let _done_12 = _def_snd_done in (let _defn_13 = (app (app (app (app _fm_synth_one _name_9) _term_10) _type_11) _defs) in (app (app (app _fm_set _name_9) _defn_13) _defs))))))))))))))))) in _defs_1))
_fm_synth_fix = (\_term-> (\_type-> (\_defs-> (\_errs-> (\_fixs-> (app (app _errs (app (app (_eli_bool _fixs) (app _maybe_some (app (app _pair_new _term) _type))) _maybe_none)) (\_errs_head-> (\_errs_tail-> (app (app (app (app (app _errs_head (\_errs_head_expected-> (\_errs_head_detected-> (\_errs_head_context-> (app (app (app (app (app _fm_synth_fix _term) _type) _defs) _errs_tail) _fixs))))) (\_errs_head_name-> (\_errs_head_dref-> (\_errs_head_verb-> (\_errs_head_goal-> (\_errs_head_context-> (app (app (app (app (app _fm_synth_fix _term) _type) _defs) _errs_tail) _fixs))))))) (\_errs_head_path-> (\_errs_head_term-> (app (app (app _errs_head_path _maybe_none) (\_errs_head_path_pred-> (let _patched_term_10 = (app (app (app _fm_term_patch_at _errs_head_path_pred) _term) (\_x-> _errs_head_term)) in (app (app (app (app (app _fm_synth_fix _patched_term_10) _type) _defs) _errs_tail) _bool_true)))) (\_errs_head_path_pred-> (let _patched_type_10 = (app (app (app _fm_term_patch_at _errs_head_path_pred) _type) (\_x-> _errs_head_term)) in (app (app (app (app (app _fm_synth_fix _term) _patched_type_10) _defs) _errs_tail) _bool_true))))))) (\_errs_head_name-> (app (app (app (app (app _fm_synth_fix _term) _type) _defs) _errs_tail) _fixs))) (\_errs_head_term-> (\_errs_head_context-> (app (app (app (app (app _fm_synth_fix _term) _type) _defs) _errs_tail) _fixs))))))))))))
_fm_synth_one = (\_name-> (\_term-> (\_type-> (\_defs-> (app (app _debug_log (app _string_flatten (app (app _list_cons "synth ") (app (app _list_cons _name) _list_nil)))) (\_x-> (let _checked_5 = (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _type) (app _maybe_some _fm_term_typ)) _defs) _list_nil) (app _fm_mpath_1 _fm_mpath_nil))) (\_chk_type-> (app (app (app _monad_bind _fm_check_monad) (app (app (app (app (app _fm_term_check _term) (app _maybe_some _type)) _defs) _list_nil) (app _fm_mpath_0 _fm_mpath_nil))) (\_chk_term-> (app (app _monad_pure _fm_check_monad) _unit_new))))) in (app _checked_5 (\_checked_value-> (\_checked_errors-> (app (app _checked_errors (app (app (app (app _fm_def_new _name) _term) _type) _bool_true)) (\_checked_errors_head-> (\_checked_errors_tail-> (let _fixed_10 = (app (app (app (app (app _fm_synth_fix _term) _type) _defs) _checked_errors) _bool_false) in (app (app _fixed_10 (app (app (app (app _fm_def_new _name) _term) _type) _bool_true)) (\_fixed_value-> (app _fixed_value (\_fixed_value_fst-> (\_fixed_value_snd-> (let _term_14 = (app (app (app _fm_term_bind _list_nil) (app _fm_path_0 _fm_path_nil)) _fixed_value_fst) in (let _type_15 = (app (app (app _fm_term_bind _list_nil) (app _fm_path_1 _fm_path_nil)) _fixed_value_snd) in (app (app (app (app _fm_synth_one _name) _term_14) _type_15) _defs))))))))))))))))))))))
_io = (\_a-> ())
_io_ask = (\_query-> (\_param-> (\_then-> (\_end-> (\_ask-> (app (app (app _ask _query) _param) _then))))))
_io_bind = (\_a-> (\_f-> (app (app _a (\_a_value-> (app _f _a_value))) (\_a_query-> (\_a_param-> (\_a_then-> (app (app (app _io_ask _a_query) _a_param) (\_x-> (app (app _io_bind (app _a_then _x)) _f)))))))))
_io_end = (\_value-> (\_end-> (\_ask-> (app _end _value))))
_io_get_args = (app (app (app _io_ask "get_args") "") (\_line-> (app _io_end _line)))
_io_get_file = (\_name-> (app (app (app _io_ask "get_file") _name) (\_file-> (app _io_end _file))))
_io_get_line = (app (app (app _io_ask "get_line") "") (\_line-> (app _io_end _line)))
_io_monad = (app (app _monad_new _io_bind) _io_end)
_io_print = (\_text-> (app (app (app _io_ask "print") _text) (\_skip-> (app _io_end _unit_new))))
_io_prompt = (\_text-> (app (app (app _io_ask "print") _text) (\_skip-> (app (app (app _io_ask "get_line") "") (\_line-> (app _io_end _line))))))
_list = (\_a-> ())
_list_at = (\_index-> (\_list-> (app (app _list _maybe_none) (\_list_head-> (\_list_tail-> (app (app (_eli_nat _index) (app _maybe_some _list_head)) (\_index_pred-> (app (app _list_at _index_pred) _list_tail))))))))
_list_at_last = (\_index-> (\_list-> (app (app _list_at _index) (app _list_reverse _list))))
_list_concat = (\_as-> (\_bs-> (app (app _as _bs) (\_as_head-> (\_as_tail-> (app (app _list_cons _as_head) (app (app _list_concat _as_tail) _bs)))))))
_list_cons = (\_head-> (\_tail-> (\_nil-> (\_cons-> (app (app _cons _head) _tail)))))
_list_eql = (\_eql-> (\_a-> (\_b-> (app (app _a (app (app _b _bool_true) (\_b_head-> (\_b_tail-> _bool_false)))) (\_a_head-> (\_a_tail-> (app (app _b _bool_false) (\_b_head-> (\_b_tail-> (app (app _bool_and (app (app _eql _a_head) _b_head)) (app (app (app _list_eql _eql) _a_tail) _b_tail)))))))))))
_list_flatten = (\_xs-> (app (app _xs _list_nil) (\_xs_head-> (\_xs_tail-> (app (app _list_concat _xs_head) (app _list_flatten _xs_tail))))))
_list_fold = (\_list-> (\_nil-> (\_cons-> (app (app _list _nil) (\_list_head-> (\_list_tail-> (app (app _cons _list_head) (app (app (app _list_fold _list_tail) _nil) _cons))))))))
_list_for = (\_xs-> (\_b-> (\_f-> (app (app _xs _b) (\_xs_head-> (\_xs_tail-> (app (app (app _list_for _xs_tail) (app (app _f _xs_head) _b)) _f)))))))
_list_length = (\_xs-> (app (app _list_length_go _xs) (0::Integer)))
_list_length_go = (\_xs-> (\_n-> (app (app _xs _n) (\_xs_head-> (\_xs_tail-> (app (app _list_length_go _xs_tail) (app _nat_succ _n)))))))
_list_map = (\_f-> (\_as-> (app (app _as _list_nil) (\_as_head-> (\_as_tail-> (app (app _list_cons (app _f _as_head)) (app (app _list_map _f) _as_tail)))))))
_list_mapped = (\_as-> (\_f-> (app (app _as _list_nil) (\_as_head-> (\_as_tail-> (app (app _list_cons (app _f _as_head)) (app (app _list_mapped _as_tail) _f)))))))
_list_nil = (\_nil-> (\_cons-> _nil))
_list_reverse = (\_xs-> (app (app _list_reverse_go _xs) _list_nil))
_list_reverse_go = (\_xs-> (\_res-> (app (app _xs _res) (\_xs_head-> (\_xs_tail-> (app (app _list_reverse_go _xs_tail) (app (app _list_cons _xs_head) _res)))))))
_map = (\_a-> ())
_map_delete = (\_key-> (\_map-> (app (app _map _map_new) (\_map_val-> (\_map_lft-> (\_map_rgt-> (app (app (app _key (app (app (app _map_tie _maybe_none) _map_lft) _map_rgt)) (\_key_pred-> (app (app _map_delete _key_pred) _map_lft))) (\_key_pred-> (app (app _map_delete _key_pred) _map_rgt)))))))))
_map_fold = (\_map-> (\_new-> (\_tie-> (app (app _map _new) (\_map_val-> (\_map_lft-> (\_map_rgt-> (app (app (app _tie _map_val) (app (app (app _map_fold _map_lft) _new) _tie)) (app (app (app _map_fold _map_rgt) _new) _tie)))))))))
_map_from_list = (\_f-> (\_xs-> (app (app _xs _map_new) (\_xs_head-> (\_xs_tail-> (app _xs_head (\_p_fst-> (\_p_snd-> (app (app (app _map_set (app _f _p_fst)) _p_snd) (app (app _map_from_list _f) _xs_tail))))))))))
_map_get = (\_bits-> (\_map-> (app (app (app _bits (app (app _map _maybe_none) (\_map_val-> (\_map_lft-> (\_map_rgt-> _map_val))))) (\_bits_pred-> (app (app _map _maybe_none) (\_map_val-> (\_map_lft-> (\_map_rgt-> (app (app _map_get _bits_pred) _map_lft))))))) (\_bits_pred-> (app (app _map _maybe_none) (\_map_val-> (\_map_lft-> (\_map_rgt-> (app (app _map_get _bits_pred) _map_rgt)))))))))
_map_new = (\_new-> (\_tie-> _new))
_map_set = (\_bits-> (\_val-> (\_map-> (app (app (app _bits (app (app _map (app (app (app _map_tie (app _maybe_some _val)) _map_new) _map_new)) (\_map_val-> (\_map_lft-> (\_map_rgt-> (app (app (app _map_tie (app _maybe_some _val)) _map_lft) _map_rgt)))))) (\_bits_pred-> (app (app _map (app (app (app _map_tie _maybe_none) (app (app (app _map_set _bits_pred) _val) _map_new)) _map_new)) (\_map_val-> (\_map_lft-> (\_map_rgt-> (app (app (app _map_tie _map_val) (app (app (app _map_set _bits_pred) _val) _map_lft)) _map_rgt))))))) (\_bits_pred-> (app (app _map (app (app (app _map_tie _maybe_none) _map_new) (app (app (app _map_set _bits_pred) _val) _map_new))) (\_map_val-> (\_map_lft-> (\_map_rgt-> (app (app (app _map_tie _map_val) _map_lft) (app (app (app _map_set _bits_pred) _val) _map_rgt)))))))))))
_map_tie = (\_val-> (\_lft-> (\_rgt-> (\_new-> (\_tie-> (app (app (app _tie _val) _lft) _rgt))))))
_map_to_list = (\_xs-> (app _list_reverse (app (app (app _map_to_list_go _xs) _bits_nil) _list_nil)))
_map_to_list_go = (\_xs-> (\_key-> (\_list-> (app (app _xs _list) (\_xs_val-> (\_xs_lft-> (\_xs_rgt-> (let _list0_7 = (app (app _xs_val _list) (\_xs_val_value-> (app (app _list_cons (app (app _pair_new (app _bits_reverse _key)) _xs_val_value)) _list))) in (let _list1_8 = (app (app (app _map_to_list_go _xs_lft) (app _bits_0 _key)) _list0_7) in (let _list2_9 = (app (app (app _map_to_list_go _xs_rgt) (app _bits_1 _key)) _list1_8) in _list2_9))))))))))
_maybe = (\_a-> ())
_maybe_bind = (\_m-> (\_f-> (app (app _m _maybe_none) (\_m_value-> (app _f _m_value)))))
_maybe_default = (\_a-> (\_m-> (app (app _m _a) (\_m_value-> _m_value))))
_maybe_mapped = (\_m-> (\_f-> (app (app _m _maybe_none) (\_m_value-> (app _maybe_some (app _f _m_value))))))
_maybe_monad = (app (app _monad_new _maybe_bind) _maybe_some)
_maybe_none = (\_none-> (\_some-> _none))
_maybe_or = (\_a-> (\_b-> (app (app _a _b) (\_a_value-> (app _maybe_some _a_value)))))
_maybe_pure = (\_a-> (app _maybe_some _a))
_maybe_some = (\_value-> (\_none-> (\_some-> (app _some _value))))
_maybe_to_bool = (\_m-> (app (app _m _bool_false) (\_m_value-> _bool_true)))
_monad = (\_m-> ())
_monad_bind = (\_m-> (app _m (\_m_bind-> (\_m_pure-> _m_bind))))
_monad_new = (\_bind-> (\_pure-> (\_new-> (app (app _new _bind) _pure))))
_monad_pure = (\_m-> (app _m (\_m_bind-> (\_m_pure-> _m_pure))))
_mutset = ()
_mutset_del = (\_bits-> (\_set-> (app _set (\_set_value-> (app _mutset_new (app (app _set_del _bits) _set_value))))))
_mutset_empty = (app _mutset_new _set_new)
_mutset_has = (\_bits-> (\_set-> (app _set (\_set_value-> (app (app _set_has _bits) _set_value)))))
_mutset_new = (\_value-> (\_new-> (app _new _value)))
_mutset_set = (\_bits-> (\_set-> (app _set (\_set_value-> (app _mutset_new (app (app _set_set _bits) _set_value))))))
_nat = ()
_nat_add = \n m-> (n::Integer) + (m::Integer)
_nat_apply = (\_n-> (\_f-> (\_x-> (app (app (_eli_nat _n) _x) (\_n_pred-> (app (app (app _nat_apply _n_pred) _f) (app _f _x)))))))
_nat_cmp = (\_a-> (\_b-> (app (app (_eli_nat _a) (app (app (_eli_nat _b) _cmp_eql) (\_b_pred-> _cmp_ltn))) (\_a_pred-> (app (app (_eli_nat _b) _cmp_gtn) (\_b_pred-> (app (app _nat_cmp _a_pred) _b_pred)))))))
_nat_div = \n m-> div (n::Integer) (m::Integer)
_nat_div_mod = \n m t-> t (div (n::Integer) (m::Integer)) (mod n m)
_nat_div_mod_go = (\_n-> (\_m-> (\_d-> (app (app (app (app _nat_sub_rem _n) _m) (\_p_value-> (app (app (app _nat_div_mod_go _p_value) _m) (app _nat_succ _d)))) (\_p_value-> (app (app _pair_new _d) _n))))))
_nat_double = (\_n-> (app (app (_eli_nat _n) _nat_zero) (\_n_pred-> (app _nat_succ (app _nat_double _n_pred)))))
_nat_eql = \n m-> (n::Integer) == (m::Integer)
_nat_from_base = (\_base-> (\_ds-> (app (app (app (app _nat_from_base_go _base) (app _list_reverse _ds)) (1::Integer)) (0::Integer))))
_nat_from_base_go = (\_b-> (\_ds-> (\_p-> (\_res-> (app (app _ds _res) (\_ds_head-> (\_ds_tail-> (app (app (app (app _nat_from_base_go _b) _ds_tail) (app (app _nat_mul _b) _p)) (app (app _nat_add (app (app _nat_mul _ds_head) _p)) _res)))))))))
_nat_gte = \n m-> (n::Integer) >= (m::Integer)
_nat_gtn = \n m-> (n::Integer) > (m::Integer)
_nat_lte = \n m-> (n::Integer) <= (m::Integer)
_nat_ltn = \n m-> (n::Integer) < (m::Integer)
_nat_mod = (\_n-> (\_m-> (app _pair_snd (app (app _nat_div_mod _n) _m))))
_nat_mul = \n m-> (n::Integer) * (m::Integer)
_nat_pred = (\_n-> (app (app (_eli_nat _n) _nat_zero) (\_n_pred-> _n_pred)))
_nat_show = (\_n-> (app (app _nat_to_string_base (10::Integer)) _n))
_nat_show_digit = (\_base-> (\_n-> (let _m_2 = (app (app _nat_mod _n) _base) in (let _base64_3 = (app (app _list_cons (48::Word16)) (app (app _list_cons (49::Word16)) (app (app _list_cons (50::Word16)) (app (app _list_cons (51::Word16)) (app (app _list_cons (52::Word16)) (app (app _list_cons (53::Word16)) (app (app _list_cons (54::Word16)) (app (app _list_cons (55::Word16)) (app (app _list_cons (56::Word16)) (app (app _list_cons (57::Word16)) (app (app _list_cons (65::Word16)) (app (app _list_cons (66::Word16)) (app (app _list_cons (67::Word16)) (app (app _list_cons (68::Word16)) (app (app _list_cons (69::Word16)) (app (app _list_cons (70::Word16)) (app (app _list_cons (71::Word16)) (app (app _list_cons (72::Word16)) (app (app _list_cons (73::Word16)) (app (app _list_cons (74::Word16)) (app (app _list_cons (75::Word16)) (app (app _list_cons (76::Word16)) (app (app _list_cons (77::Word16)) (app (app _list_cons (78::Word16)) (app (app _list_cons (79::Word16)) (app (app _list_cons (80::Word16)) (app (app _list_cons (81::Word16)) (app (app _list_cons (82::Word16)) (app (app _list_cons (83::Word16)) (app (app _list_cons (84::Word16)) (app (app _list_cons (85::Word16)) (app (app _list_cons (86::Word16)) (app (app _list_cons (87::Word16)) (app (app _list_cons (88::Word16)) (app (app _list_cons (89::Word16)) (app (app _list_cons (90::Word16)) (app (app _list_cons (97::Word16)) (app (app _list_cons (98::Word16)) (app (app _list_cons (99::Word16)) (app (app _list_cons (100::Word16)) (app (app _list_cons (101::Word16)) (app (app _list_cons (102::Word16)) (app (app _list_cons (103::Word16)) (app (app _list_cons (104::Word16)) (app (app _list_cons (105::Word16)) (app (app _list_cons (106::Word16)) (app (app _list_cons (107::Word16)) (app (app _list_cons (108::Word16)) (app (app _list_cons (109::Word16)) (app (app _list_cons (110::Word16)) (app (app _list_cons (111::Word16)) (app (app _list_cons (112::Word16)) (app (app _list_cons (113::Word16)) (app (app _list_cons (114::Word16)) (app (app _list_cons (115::Word16)) (app (app _list_cons (116::Word16)) (app (app _list_cons (117::Word16)) (app (app _list_cons (118::Word16)) (app (app _list_cons (119::Word16)) (app (app _list_cons (120::Word16)) (app (app _list_cons (121::Word16)) (app (app _list_cons (122::Word16)) (app (app _list_cons (43::Word16)) (app (app _list_cons (47::Word16)) _list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (app (app (_eli_bool (app (app _bool_and (app (app _nat_gtn _base) (0::Integer))) (app (app _nat_lte _base) (64::Integer)))) (app (app (app (app _list_at _m_2) _base64_3) (35::Word16)) (\_c_value-> _c_value))) (35::Word16))))))
_nat_sub = \n m-> max ((n::Integer) - (m::Integer)) 0
_nat_sub_rem = (\_n-> (\_m-> (app (app (_eli_nat _m) (app _either_left _n)) (\_m_pred-> (app (app (_eli_nat _n) (app _either_right (app _nat_succ _m_pred))) (\_n_pred-> (app (app _nat_sub_rem _n_pred) _m_pred)))))))
_nat_succ = (\_pred-> (_ins_nat (\_zero-> (\_succ-> (app _succ _pred)))))
_nat_to_base = (\_base-> (\_nat-> (app (app (app _nat_to_base_go _base) _nat) _list_nil)))
_nat_to_base_go = (\_base-> (\_nat-> (\_res-> (app (app (app _nat_div_mod _nat) _base) (\_div_mod_fst-> (\_div_mod_snd-> (app (app (_eli_nat _div_mod_fst) (app (app _list_cons _div_mod_snd) _res)) (\_div_mod_fst_pred-> (app (app (app _nat_to_base_go _base) _div_mod_fst) (app (app _list_cons _div_mod_snd) _res))))))))))
_nat_to_bits = (\_n-> (app (app (_eli_nat _n) _bits_nil) (\_n_pred-> (app _bits_inc (app _nat_to_bits _n_pred)))))
_nat_to_string_base = (\_base-> (\_nat-> (app (app (app _list_fold (app (app _nat_to_base _base) _nat)) _string_nil) (\_n-> (\_str-> (app (app _string_cons (app (app _nat_show_digit _base) _n)) _str))))))
_nat_to_u16 = \n-> (fromInteger (n::Integer)) :: Word16
_nat_zero = (_ins_nat (\_zero-> (\_succ-> _zero)))
_pair = (\_a-> (\_b-> ()))
_pair_fst = (\_pair-> (app _pair (\_pair_fst-> (\_pair_snd-> _pair_fst))))
_pair_new = (\_fst-> (\_snd-> (\_new-> (app (app _new _fst) _snd))))
_pair_snd = (\_pair-> (app _pair (\_pair_fst-> (\_pair_snd-> _pair_snd))))
_parser = (\_v-> ())
_parser_reply = (\_v-> ())
_parser_reply_error = (\_code-> (\_err-> (\_error-> (\_value-> (app (app _error _code) _err)))))
_parser_reply_value = (\_code-> (\_val-> (\_error-> (\_value-> (app (app _value _code) _val)))))
_parser_bind = (\_parse-> (\_next-> (\_code-> (app (app (app _parse _code) (\_reply_code-> (\_reply_err-> (app (app _parser_reply_error _reply_code) _reply_err)))) (\_reply_code-> (\_reply_val-> (app (app _next _reply_val) _reply_code)))))))
_parser_char_if = (\_fun-> (\_code-> (app (app (_eli_string _code) (app (app _parser_reply_error _code) "No parse.")) (\_code_head-> (\_code_tail-> (app (app (_eli_bool (app _fun _code_head)) (app (app _parser_reply_value _code_tail) _code_head)) (app (app _parser_reply_error _code) "No parse.")))))))
_parser_digit = (\_code-> (app (app (_eli_string _code) (app (app _parser_reply_error _code) "No parse.")) (\_code_head-> (\_code_tail-> (app (app (_eli_bool (app (app _u16_eql _code_head) (48::Word16))) (app (app _parser_reply_value _code_tail) (0::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (49::Word16))) (app (app _parser_reply_value _code_tail) (1::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (50::Word16))) (app (app _parser_reply_value _code_tail) (2::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (51::Word16))) (app (app _parser_reply_value _code_tail) (3::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (52::Word16))) (app (app _parser_reply_value _code_tail) (4::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (53::Word16))) (app (app _parser_reply_value _code_tail) (5::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (54::Word16))) (app (app _parser_reply_value _code_tail) (6::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (55::Word16))) (app (app _parser_reply_value _code_tail) (7::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (56::Word16))) (app (app _parser_reply_value _code_tail) (8::Integer))) (app (app (_eli_bool (app (app _u16_eql _code_head) (57::Word16))) (app (app _parser_reply_value _code_tail) (9::Integer))) (app (app _parser_reply_error _code) "No parse.")))))))))))))))
_parser_first_of = (\_pars-> (\_code-> (app (app _pars (app (app _parser_reply_error _code) "No parse.")) (\_pars_head-> (\_pars_tail-> (let _parsed_5 = (app _pars_head _code) in (app (app _parsed_5 (\_parsed_code-> (\_parsed_err-> (app (app _parser_first_of _pars_tail) _code)))) (\_parsed_code-> (\_parsed_val-> (app (app _parser_reply_value _parsed_code) _parsed_val))))))))))
_parser_get_code = (\_code-> (app (app _parser_reply_value _code) _code))
_parser_if_not = (\_a-> (\_b-> (\_code-> (app (app (app _a _code) (\_self_code-> (\_self_err-> (app _b _code)))) (\_self_code-> (\_self_val-> (app (app _parser_reply_error _code) "Prevented.")))))))
_parser_log = (\_str-> (\_code-> (app (app _debug_log _str) (\_x-> (app (app _parser_reply_value _code) _unit_new)))))
_parser_log_code = (\_code-> (app (app _debug_log _code) (\_x-> (app (app _parser_reply_value _code) _unit_new))))
_parser_many = (\_parser-> (app (app _parser_many_go _parser) (\_x-> _x)))
_parser_many1 = (\_parser-> (app (app (app _monad_bind _parser_monad) _parser) (\_head-> (app (app (app _monad_bind _parser_monad) (app _parser_many _parser)) (\_tail-> (app (app _monad_pure _parser_monad) (app (app _list_cons _head) _tail)))))))
_parser_many_go = (\_parse-> (\_values-> (\_code-> (app (app (app _parse _code) (\_reply_code-> (\_reply_err-> (app (app _parser_reply_value _code) (app _values _list_nil))))) (\_reply_code-> (\_reply_val-> (app (app (app _parser_many_go _parse) (\_xs-> (app _values (app (app _list_cons _reply_val) _xs)))) _reply_code)))))))
_parser_maybe = (\_parse-> (\_code-> (app (app (app _parse _code) (\_reply_code-> (\_reply_err-> (app (app _parser_reply_value _code) _maybe_none)))) (\_reply_code-> (\_reply_val-> (app (app _parser_reply_value _reply_code) (app _maybe_some _reply_val)))))))
_parser_monad = (app (app _monad_new _parser_bind) _parser_pure)
_parser_nat = (app (app (app _monad_bind _parser_monad) (app _parser_many1 _parser_digit)) (\_digits-> (app (app _monad_pure _parser_monad) (app (app _nat_from_base (10::Integer)) _digits))))
_parser_one = (\_code-> (app (app (_eli_string _code) (app (app _parser_reply_error _code) "Unexpected end of file.")) (\_code_head-> (\_code_tail-> (app (app _parser_reply_value _code_tail) _code_head)))))
_parser_pure = (\_value-> (\_code-> (app (app _parser_reply_value _code) _value)))
_parser_spaces = (app _parser_many (app _parser_first_of (app (app _list_cons (app _parser_text " ")) (app (app _list_cons (app _parser_text "\n")) _list_nil))))
_parser_spaces_text = (\_text-> (app (app (app _monad_bind _parser_monad) _parser_spaces) (\_-> (app _parser_text _text))))
_parser_text = (\_text-> (\_code-> (app (app (app (app _parser_text_go _text) _code) (\_reply_code-> (\_reply_err-> (app (app _parser_reply_error _code) _reply_err)))) (\_reply_code-> (\_reply_val-> (app (app _parser_reply_value _reply_code) _reply_val))))))
_parser_text_go = (\_text-> (\_code-> (app (app (_eli_string _text) (app (app _parser_reply_value _code) _unit_new)) (\_text_head-> (\_text_tail-> (app (app (_eli_string _code) (let _error_4 = (app _string_flatten (app (app _list_cons "Expected \'") (app (app _list_cons _text) (app (app _list_cons "\', found end of file.") _list_nil)))) in (app (app _parser_reply_error _code) _error_4))) (\_code_head-> (\_code_tail-> (app (app (_eli_bool (app (app _u16_eql _text_head) _code_head)) (app (app _parser_text _text_tail) _code_tail)) (let _error_6 = (app _string_flatten (app (app _list_cons "Expected \'") (app (app _list_cons _text) (app (app _list_cons "\', found \'") (app (app _list_cons (app (app _string_cons _code_head) _string_nil)) (app (app _list_cons "\'.") _list_nil)))))) in (app (app _parser_reply_error _code) _error_6)))))))))))
_parser_until = (\_cond-> (\_parser-> (app _parser_many (app (app _parser_if_not _cond) _parser))))
_set = (app _map _unit)
_set_del = (\_key-> (\_set-> (app (app _map_delete _key) _set)))
_set_has = (\_bits-> (\_set-> (app (app (app (app _map_get _bits) _set) _bool_false) (\_self_value-> _bool_true))))
_set_new = _map_new
_set_set = (\_bits-> (\_set-> (app (app (app _map_set _bits) _unit_new) _set)))
_string = ()
_stringmap = (\_a-> ())
_stringmap_cons = (\_key-> (\_val-> (\_tail-> (\_nil-> (\_cons-> (app (app (app _cons _key) _val) _tail))))))
_stringmap_from_list = (\_list-> (app (app _list _stringmap_nil) (\_list_head-> (\_list_tail-> (app _list_head (\_list_head_fst-> (\_list_head_snd-> (app (app (app _stringmap_cons _list_head_fst) _list_head_snd) (app _stringmap_from_list _list_tail)))))))))
_stringmap_get = (\_key-> (\_map-> (app (app _map _maybe_none) (\_map_key-> (\_map_val-> (\_map_tail-> (app (app (_eli_bool (app (app _string_eql _map_key) _key)) (app _maybe_some _map_val)) (app (app _stringmap_get _key) _map_tail))))))))
_stringmap_new = _stringmap_nil
_stringmap_nil = (\_nil-> (\_cons-> _nil))
_stringmap_set = (\_key-> (\_val-> (\_map-> (app (app _map (app (app (app _stringmap_cons _key) _val) _stringmap_nil)) (\_map_key-> (\_map_val-> (\_map_tail-> (app (app (_eli_bool (app (app _string_eql _map_key) _key)) (app (app (app _stringmap_cons _key) _val) _map_tail)) (app (app (app _stringmap_cons _map_key) _map_val) (app (app (app _stringmap_set _key) _val) _map_tail))))))))))
_stringmap_to_list = (\_map-> (app (app _map _list_nil) (\_map_key-> (\_map_val-> (\_map_tail-> (app (app _list_cons (app (app _pair_new _map_key) _map_val)) (app _stringmap_to_list _map_tail)))))))
_string_concat = (\_as-> (\_bs-> (_as::String) ++ _bs))
_string_cons = (\_head-> (\_tail-> (_head::Char) : (_tail::String)))
_string_eql = (\_a-> (\_b-> (_a::String) == _b))
_string_flatten = (\_xs-> (app (app _string_flatten_go _xs) ""))
_string_flatten_go = (\_xs-> (\_res-> (app (app _xs _res) (\_xs_head-> (\_xs_tail-> (app (app _string_flatten_go _xs_tail) (app (app _string_concat _res) _xs_head)))))))
_string_is_empty = (\_str-> (app (app (_eli_string _str) _bool_true) (\_str_head-> (\_str_tail-> _bool_false))))
_string_join = (\_sep-> (\_list-> (app (app (app _string_join_go _sep) _list) _bool_true)))
_string_join_go = (\_sep-> (\_list-> (\_fst-> (app (app _list "") (\_list_head-> (\_list_tail-> (app _string_flatten (app (app _list_cons (app (app (_eli_bool _fst) "") _sep)) (app (app _list_cons _list_head) (app (app _list_cons (app (app (app _string_join_go _sep) _list_tail) _bool_false)) _list_nil))))))))))
_string_nil = (_ins_string (\_nil-> (\_cons-> _nil)))
_unit = ()
_unit_new = (\_new-> _new)
_u16 = ()
_u16_add = \n m-> (n::Word16) + (m::Word16)
_u16_btw = (\_a-> (\_b-> (\_c-> (app (app _bool_and (app (app _u16_lte _a) _b)) (app (app _u16_lte _b) _c)))))
_u16_eql = \n m-> (n::Word16) == (m::Word16)
_u16_gte = \n m-> (n::Word16) >= (m::Word16)
_u16_gtn = \n m-> (n::Word16) > (m::Word16)
_u16_inc = (\_a-> (app (_eli_u16 _a) (\_a_value-> (app _u16_new (app _word_inc _a_value)))))
_u16_lte = \n m-> (n::Word16) <= (m::Word16)
_u16_ltn = \n m-> (n::Word16) < (m::Word16)
_u16_new = (\_value-> (_ins_u16 (\_new-> (app _new _value))))
_u16_sub = \n m-> (n::Word16) - (m::Word16)
_u16_to_word = (\_a-> (app (_eli_u16 _a) (\_a_value-> _a_value)))
_u16_zero = (app _u16_new (app _word_zero (16::Integer)))
_word = (\_size-> ())
_word_add = (\_a-> (\_b-> (app (app (app _word_adder _a) _b) _bool_false)))
_word_adder = (\_a-> (\_b-> (\_c-> (app (app (app (app _a (\_b-> _word_nil)) (\_a_pred-> (\_b-> (app (app (app (app _b (\_a_pred-> _word_nil)) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_1 (app (app (app _word_adder _a_pred) _b_pred) _bool_false))) (app _word_0 (app (app (app _word_adder _a_pred) _b_pred) _bool_false)))))) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_0 (app (app (app _word_adder _a_pred) _b_pred) _bool_true))) (app _word_1 (app (app (app _word_adder _a_pred) _b_pred) _bool_false)))))) _a_pred)))) (\_a_pred-> (\_b-> (app (app (app (app _b (\_a_pred-> _word_nil)) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_0 (app (app (app _word_adder _a_pred) _b_pred) _bool_true))) (app _word_1 (app (app (app _word_adder _a_pred) _b_pred) _bool_false)))))) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_1 (app (app (app _word_adder _a_pred) _b_pred) _bool_true))) (app _word_0 (app (app (app _word_adder _a_pred) _b_pred) _bool_true)))))) _a_pred)))) _b))))
_word_btw = (\_a-> (\_b-> (\_c-> (app (app _bool_and (app (app _word_lte _a) _b)) (app (app _word_lte _b) _c)))))
_word_cmp = (\_a-> (\_b-> (app (app (app _word_cmp_go _a) _b) _cmp_eql)))
_word_cmp_go = (\_a-> (\_b-> (\_c-> (app (app (app (app _a (\_b-> _c)) (\_a_pred-> (\_b-> (app (app (app (app _b (\_a_pred-> _c)) (\_b_pred-> (\_a_pred-> (app (app (app _word_cmp_go _a_pred) _b_pred) _c)))) (\_b_pred-> (\_a_pred-> (app (app (app _word_cmp_go _a_pred) _b_pred) _cmp_ltn)))) _a_pred)))) (\_a_pred-> (\_b-> (app (app (app (app _b (\_a_pred-> _c)) (\_b_pred-> (\_a_pred-> (app (app (app _word_cmp_go _a_pred) _b_pred) _cmp_gtn)))) (\_b_pred-> (\_a_pred-> (app (app (app _word_cmp_go _a_pred) _b_pred) _c)))) _a_pred)))) _b))))
_word_eql = (\_a-> (\_b-> (app _cmp_as_eql (app (app _word_cmp _a) _b))))
_word_fold = (\_nil-> (\_w0-> (\_w1-> (\_word-> (app (app (app _word _nil) (\_word_pred-> (app _w0 (app (app (app (app _word_fold _nil) _w0) _w1) _word_pred)))) (\_word_pred-> (app _w1 (app (app (app (app _word_fold _nil) _w0) _w1) _word_pred))))))))
_word_foldl = (\_nil-> (\_w0-> (\_w1-> (\_word-> (app (app (app _word _nil) (\_word_pred-> (app (app (app (app _word_foldl (app _w0 _nil)) _w0) _w1) _word_pred))) (\_word_pred-> (app (app (app (app _word_foldl (app _w1 _nil)) _w0) _w1) _word_pred)))))))
_word_from_bits = (\_size-> (\_bits-> (app (app (_eli_nat _size) _word_nil) (\_size_pred-> (app (app (app _bits (app _word_0 (app (app _word_from_bits _size_pred) _bits_nil))) (\_bits_pred-> (app _word_0 (app (app _word_from_bits _size_pred) _bits_pred)))) (\_bits_pred-> (app _word_1 (app (app _word_from_bits _size_pred) _bits_pred))))))))
_word_gte = (\_a-> (\_b-> (app _cmp_as_gte (app (app _word_cmp _a) _b))))
_word_gtn = (\_a-> (\_b-> (app _cmp_as_gtn (app (app _word_cmp _a) _b))))
_word_inc = (\_word-> (app (app (app _word _word_nil) (\_word_pred-> (app _word_1 _word_pred))) (\_word_pred-> (app _word_0 (app _word_inc _word_pred)))))
_word_lte = (\_a-> (\_b-> (app _cmp_as_lte (app (app _word_cmp _a) _b))))
_word_ltn = (\_a-> (\_b-> (app _cmp_as_ltn (app (app _word_cmp _a) _b))))
_word_nil = (\_nil-> (\_0-> (\_1-> _nil)))
_word_sub = (\_a-> (\_b-> (app (app (app _word_subber _a) _b) _bool_false)))
_word_subber = (\_a-> (\_b-> (\_c-> (app (app (app (app _a (\_b-> _word_nil)) (\_a_pred-> (\_b-> (app (app (app (app _b (\_a_pred-> _word_nil)) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_1 (app (app (app _word_subber _a_pred) _b_pred) _bool_true))) (app _word_0 (app (app (app _word_subber _a_pred) _b_pred) _bool_false)))))) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_0 (app (app (app _word_subber _a_pred) _b_pred) _bool_true))) (app _word_1 (app (app (app _word_subber _a_pred) _b_pred) _bool_true)))))) _a_pred)))) (\_a_pred-> (\_b-> (app (app (app (app _b (\_a_pred-> _word_nil)) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_0 (app (app (app _word_subber _a_pred) _b_pred) _bool_false))) (app _word_1 (app (app (app _word_subber _a_pred) _b_pred) _bool_false)))))) (\_b_pred-> (\_a_pred-> (app (app (_eli_bool _c) (app _word_1 (app (app (app _word_subber _a_pred) _b_pred) _bool_true))) (app _word_0 (app (app (app _word_subber _a_pred) _b_pred) _bool_false)))))) _a_pred)))) _b))))
_word_to_bits = (\_a-> (app (app (app _a _bits_nil) (\_a_pred-> (app _bits_0 (app _word_to_bits _a_pred)))) (\_a_pred-> (app _bits_1 (app _word_to_bits _a_pred)))))
_word_trim = (\_new_size-> (\_word-> (app (app (_eli_nat _new_size) _word_nil) (\_new_size_pred-> (app (app (app _word (app _word_0 (app (app _word_trim _new_size_pred) _word_nil))) (\_word_pred-> (app _word_0 (app (app _word_trim _new_size_pred) _word_pred)))) (\_word_pred-> (app _word_1 (app (app _word_trim _new_size_pred) _word_pred))))))))
_word_zero = (\_size-> (app (app (_eli_nat _size) _word_nil) (\_size_pred-> (app _word_0 (app _word_zero _size_pred)))))
_word_0 = (\_pred-> (\_nil-> (\_0-> (\_1-> (app _0 _pred)))))
_word_1 = (\_pred-> (\_nil-> (\_0-> (\_1-> (app _1 _pred)))))
_check = (\_file-> (let _defs_1 = (app (app _maybe_default _map_new) (app _fm_defs_read _file)) in (let _defs_2 = (app _fm_synth _defs_1) in (app _fm_report _defs_2))))
_main = (let _sstr_0 = _fm_term_serialize_string in (app (app (app _monad_bind _io_monad) _io_get_args) (\_name-> (let _name_2 = (app (app (_eli_string _name) "main.fm") (\_name_head-> (\_name_tail-> _name))) in (let _name_3 = "main.fm" in (app (app (app _monad_bind _io_monad) (app _io_get_file _name_3)) (\_file-> (let _defs_5 = (app (app _maybe_default _map_new) (app _fm_defs_read _file)) in (let _defs_6 = (app _fm_synth _defs_5) in (let _report_7 = (app _fm_report _defs_6) in (app (app (app _monad_bind _io_monad) (app _io_print _report_7)) (\_-> (app _io_print (app _fm_comp_hs_defs _defs_6))))))))))))))

main :: IO ()
main = do
  file <- readFile "./main.fm"
  putStrLn (_check file)
